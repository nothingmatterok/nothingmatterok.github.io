System.register("chunks:///_virtual/AIActionConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./SLGBattleEvtQueueManager.ts","./SLGBattleMapManager.ts","./SLGTileManager.ts","./SLGBattleChar.ts","./StaticConfig.ts"],(function(e){var a,n,r,t,i,l,s,u;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){r=e.SceneManager},function(e){t=e.SLGCharSkillCastEvent},function(e){i=e.SLGBattleMapManager},function(e){l=e.SLGTileManager},function(e){s=e.SLGBTCAMP},function(e){u=e.GSC}],execute:function(){function o(e,n){for(var t,l=r.ins.curScene,u=1e4,o=a(l.charManager.charsOnStage);!(t=o()).done;){var m=t.value;if(m.camp==s.PLAYER&&m.alive){var v=i.MapDis(m.tileX,m.tileY,e,n);v<u&&(u=v)}}return u}function m(e,a,n){if(a.preCalkillNum>e.preCalkillNum)return!0;if(a.preCalkillNum<e.preCalkillNum)return!1;if(a.preCalTotalDamage>e.preCalTotalDamage)return!0;if(a.preCalTotalDamage<e.preCalTotalDamage)return!1;if(a.minDis<=n&&e.minDis>n)return!0;if(e.minDis<=n&&a.minDis>n)return!1;if(a.minDis<=n&&e.minDis<=n){if(a.minDisDecreaseNum>e.minDisDecreaseNum)return!1;if(a.minDisDecreaseNum<e.minDisDecreaseNum)return!0}if(a.minDis>n&&e.minDis>n){if(a.minDisDecreaseNum>e.minDisDecreaseNum)return!0;if(a.minDisDecreaseNum<e.minDisDecreaseNum)return!1}return a.apRemain>e.apRemain}n._RF.push({},"e9fcf88nj9NpbJhtrD17FAr","AIActionConfig",void 0);e("AIActions",{AIBase:function(e){for(var n,s=o(e.tileX,e.tileY),v=e.getNormalAtkRange(),c=r.ins.curScene,d={apRemain:e.ap,moveDesXY:[e.tileX,e.tileY],preCalkillNum:0,preCalTotalDamage:0,minDisDecreaseNum:0,minDis:s},p=c.mapManager.getMovableFieldMap(e),D=a(p.keys());!(n=D()).done;){var f=n.value,g=l.getXYById(f),C=g[0],M=g[1];if(c.mapManager.canMoveInMField(C,M,p)||C==e.tileX&&M==e.tileY){for(var k,I=p.get(f),S=i.unZipAPIDNum(I),A=S[0],N=(S[1],o(C,M)),R=s-N,Y=a(e.skillIdAndCDs);!(k=Y()).done;){var X=k.value,T=u.SKSC[X[0]];if(A>=T.apCost&&0==X[1])for(var E,h=A-T.apCost,B=c.mapManager.getCastRangeResult(C,M,T.castRange),L=a(B);!(E=L()).done;){for(var Q,G=E.value,y=l.getXYById(G),F=y[0],x=y[1],w=c.mapManager.getEffectRangeResult(F,x,T.effectRange),K=0,P=0,b=a(w);!(Q=b()).done;){var _=Q.value,j=l.getXYById(_),H=j[0],O=j[1],J=c.charManager.getCharFromXY(H,O);T.preCalRatio<0?J&&J.camp==e.camp&&(K+=T.preCalRatio*e.attr.atk):J&&J.camp!=e.camp&&(K+=T.preCalRatio*(e.attr.atk-J.attr.def))>=J.hp&&(P+=1)}var Z={apRemain:h,moveDesXY:[C,M],skillIdAndCd:X,targetTile:[F,x],preCalkillNum:P,preCalTotalDamage:K,minDisDecreaseNum:R,minDis:N};m(d,Z,v)&&(d=Z)}}var q={apRemain:A,moveDesXY:[C,M],preCalkillNum:0,preCalTotalDamage:0,minDisDecreaseNum:R,minDis:N};m(d,q,v)&&(d=q)}}if(null==d.skillIdAndCd&&d.minDisDecreaseNum<=0)return!1;if(d.moveDesXY[0]==e.tileX&&d.moveDesXY[1]==e.tileY){var z=new t({caster:e,skillId:d.skillIdAndCd[0],skillIdAndCd:d.skillIdAndCd,params:{targetTileXY:d.targetTile}});c.evtQManager.insertEvent(z),c.evtQManager.nextEvt()}else{var U;(U=c.charManager).charMoveTo.apply(U,[e].concat(d.moveDesXY,[p]))}return!0},AIBossTest:function(e){for(var n,i=r.ins.curScene,l=a(e.skillIdAndCDs);!(n=l()).done;){var s=n.value;if(5==s[0]&&0==s[1]&&u.SKSC[5].apCost<=e.ap){var o=new t({caster:e,skillId:5,skillIdAndCd:s});return i.evtQManager.insertEvent(o),i.evtQManager.nextEvt(),!0}}for(var m,v=a(e.skillIdAndCDs);!(m=v()).done;){var c=m.value;if(4==c[0]&&0==c[1]&&u.SKSC[4].apCost<=e.ap){var d=new t({caster:e,skillId:4,skillIdAndCd:c});return i.evtQManager.insertEvent(d),i.evtQManager.nextEvt(),!0}}for(var p,D=a(e.skillIdAndCDs);!(p=D()).done;){var f=p.value;if(3==f[0]&&0==f[1]&&u.SKSC[3].apCost<=e.ap){var g=new t({caster:e,skillId:3,skillIdAndCd:f});return i.evtQManager.insertEvent(g),i.evtQManager.nextEvt(),!0}}for(var C,M=a(e.skillIdAndCDs);!(C=M()).done;){var k=C.value;if(12==k[0]&&0==k[1]&&u.SKSC[12].apCost<=e.ap){var I=new t({caster:e,skillId:12,skillIdAndCd:k});return i.evtQManager.insertEvent(I),i.evtQManager.nextEvt(),!0}}return!1}});n._RF.pop()}}}));

System.register("chunks:///_virtual/AIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Queue.ts","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./SLGBattleChar.ts"],(function(e){var n,t,r,i,a,u,c,s;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy,r=e.log},function(e){i=e.Queue},function(e){a=e.MessageManager},function(e){u=e.SceneManager},function(e){c=e.MT},function(e){s=e.SLGBTCAMP}],execute:function(){t._RF.push({},"70981tbznVAyIi41swTsqLu","AIManager",void 0);e("AIManager",function(){function e(){this.curEnemy=void 0,this.AIActionData=new Map,this._enemyDoQueue=new i}var t=e.prototype;return t.init=function(){a.ins.addListener(c.CURENEMYACTIONDONE,this._CurEnemyAction,this)},t.AIStart=function(){var e=u.ins.curScene;this._enemyDoQueue.clear();for(var t,r=n(e.charManager.charsOnStage);!(t=r()).done;){var i=t.value;i.alive&&i.camp==s.ENEMY&&this._enemyDoQueue.enqueue(i)}this._nextEnemyStartAction()},t._nextEnemyStartAction=function(){this.curEnemy=null;var e=u.ins.curScene;if(this._enemyDoQueue.size>0){var n=this._enemyDoQueue.dequeue();this.curEnemy=n,this._CurEnemyAction(),e.charManager.selectChar(n)}else e.phaseManager.nextPhase()},t._CurEnemyAction=function(){this.curEnemy.AIActionFunc(this.curEnemy)?r(this.curEnemy.charName,"行动成功"):(r(this.curEnemy&&this.curEnemy.charName,"行动结束"),this._nextEnemyStartAction())},t.release=function(){a.ins.removeListener(c.CURENEMYACTIONDONE,this._CurEnemyAction,this)},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/AsyncLoad.ts",["cc"],(function(n){var o,e,u;return{setters:[function(n){o=n.cclegacy,e=n.resources,u=n.assetManager}],execute:function(){o._RF.push({},"5dbe80oT+dJUoQUlIpgEu1G","AsyncLoad",void 0);n("AsyncLoad",function(){function n(){}return n.loadFromResources=function(n,o,u){return new Promise((function(t,c){e.load(n,o,(function(n,o){n?c(n):(u&&u(o),t(o))}))}))},n.loadRemovte=function(n,o){return void 0===o&&(o=null),new Promise((function(e,t){u.loadRemote(n,(function(n,u){n?t(n):(o&&o(u),e(u))}))}))},n.loadBundle=function(n,o){return void 0===o&&(o=null),new Promise((function(e,t){u.loadBundle(n,(function(n,u){n?t(n):(o&&o(u),e(u))}))}))},n.loadFromBundle=function(n,o,e,u){return new Promise((function(t,c){n.load(o,e,(function(n,o){n?c(n):(u&&u(o),t(o))}))}))},n}());o._RF.pop()}}}));

System.register("chunks:///_virtual/AudioEffectController.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var e,t,i,r,n,c,l,u,a;return{setters:[function(o){e=o.applyDecoratedDescriptor,t=o.inheritsLoose,i=o.initializerDefineProperty,r=o.assertThisInitialized},function(o){n=o.cclegacy,c=o._decorator,l=o.AudioClip,u=o.AudioSource,a=o.Component}],execute:function(){var p,s,f,d,h;n._RF.push({},"f87f3UWgqZF8oPUDmYfbpTj","AudioEffectController",void 0);var y=c.ccclass,v=c.property;o("AudioEffectController",(p=y("AudioEffectController"),s=v({type:[l]}),p((h=e((d=function(o){function e(){for(var e,t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return e=o.call.apply(o,[this].concat(n))||this,i(e,"clips",h,r(e)),e._audioSource=void 0,e}t(e,o);var n=e.prototype;return n.init=function(){var o=this.node.getComponent(u);this._audioSource=o},n.playOneShotInClips=function(o){this._audioSource.playOneShot(this.clips[o],1)},e}(a)).prototype,"clips",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=d))||f));n._RF.pop()}}}));

System.register("chunks:///_virtual/BaseToast.ts",["cc"],(function(t){var e,i,o,n,s,h,r,d,a,g,N,p,l,v,c,u,A;return{setters:[function(t){e=t.cclegacy,i=t.UIOpacity,o=t.tween,n=t.Label,s=t.UITransform,h=t.v3,r=t.Node,d=t.Layers,a=t.Canvas,g=t.director,N=t.view,p=t.BlockInputEvents,l=t.Sprite,v=t.Texture2D,c=t.ImageAsset,u=t.SpriteFrame,A=t.color}],execute:function(){e._RF.push({},"48dfb7QiYNAEJ9jNqw/Xh2H","BaseToast",void 0);var T=t("Gravity",function(t){return t[t.BOTTOM=0]="BOTTOM",t[t.CENTER=1]="CENTER",t[t.TOP=2]="TOP",t}({})),m=t("BaseToast",function(){function t(e){this.isDestroy=!1,this.bgNode=void 0,this.textNode=void 0,this.node=void 0,this.text="",this.time=t.LENGTH_SHORT,this.textSize=14,this.lineHeight=2,this.gravity=T.TOP,this.node=null==e?this.getPNode():e,this.bgNode=new r,this.bgNode.layer=d.Enum.UI_2D,this.bgNode.addComponent(p);var i=this.bgNode.addComponent(l);i.type=l.Type.SLICED;var o=new Image;o.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACAQMAAABIeJ9nAAAAA1BMVEX///+nxBvIAAAACklEQVQI12MAAgAABAABINItbwAAAABJRU5ErkJggg==";var h=new v;h.image=new c(o);var a=new u;a.texture=h,i.spriteFrame=a,i.color=A(0,0,0,200),this.bgNode.active=!1,this.textNode=new r("Text"),this.textNode.layer=d.Enum.UI_2D,this.textNode.addComponent(s).width=this.node.getComponent(s).width;var g=this.textNode.addComponent(n);g.horizontalAlign=n.HorizontalAlign.CENTER,g.verticalAlign=n.VerticalAlign.CENTER,this.textNode.parent=this.bgNode,this.bgNode.parent=this.node}t.makeText=function(e,i,o){var n=new t(o);return n.text=e,n.time=i,n};var e=t.prototype;return e.show=function(){var t=this;this.setText(this.text).setTextSize(this.textSize).setOverFlow(),this.bgNode.active=!0,this.isDestroy=!1;var e=this.bgNode.getComponent(i);null==e&&(e=this.bgNode.addComponent(i)),o(e).delay(this.time).to(.3,{opacity:0}).call((function(){t.bgNode.active=!1,t.bgNode.destroy(),t.isDestroy=!0})).start()},e.setText=function(t){return this.text=t,this.textNode.getComponent(n).string=this.text,this},e.setTextSize=function(t){return this.textSize=t,this.textNode.getComponent(n).fontSize=this.textSize,this},e.setLineheight=function(t){return this.lineHeight=t,this},e.setTime=function(t){return this.time=t,this},e.setGravity=function(t){return this.gravity=t,this},e.setPosition=function(){var t=this.node.getComponent(s),e=this.bgNode.getComponent(s);switch(this.gravity){case T.BOTTOM:var i=-t.height/2+e.height/2+64;this.bgNode.position=h(0,i,0);break;case T.CENTER:e.width,e.height;this.bgNode.position=h(0,0,0);break;case T.TOP:var o=t.height/2-e.height/2-64;this.bgNode.position=h(0,o,0)}},e.setOverFlow=function(){var t=this.node.getComponent(s).width/2,e=this.textNode.getComponent(n),i=this.text.length*e.fontSize,o=this.textNode.getComponent(s);i>t?(o.width=t,e.overflow=n.Overflow.RESIZE_HEIGHT):(o.width=i,e.overflow=n.Overflow.NONE);var h=this.bgNode.getComponent(s);h.width=o.width+4*e.fontSize,h.height=e.fontSize*this.lineHeight,this.setPosition()},e.getPNode=function(){if(null==t.pNode||!t.pNode.isValid){var e;t.pNode=new r("Toast");var i=t.pNode.addComponent(s);t.pNode.layer=d.Enum.UI_2D,t.pNode.addComponent(a),null==(e=g.getScene())||e.addChild(t.pNode);var o=N.getVisibleSize();i.contentSize=o,i.width=o.width,i.height=o.height,t.pNode.position=h(o.width/2,o.height/2,0)}return t.pNode},t}());m.LENGTH_SHORT=2,m.LENGTH_LONG=3.5,m.pNode=null,e._RF.pop()}}}));

System.register("chunks:///_virtual/Buff.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./StaticConfig.ts"],(function(t){var e,n,r,f,i;return{setters:[function(t){e=t.createForOfIteratorHelperLoose,n=t.createClass},function(t){r=t.cclegacy},function(t){f=t.SceneManager},function(t){i=t.GSC}],execute:function(){r._RF.push({},"0c878fo3eZPGZBZz9wZ3rnf","Buff",void 0);t("Buff",function(){function t(){this.staticInfo=void 0,this.duration=void 0,this.caster=void 0,this.target=void 0,this.children=[]}var r=t.prototype;return r.initial=function(t,e){this.staticInfo=i.BFSC[t];var n=i.BFSC[t];this.caster=e,this.duration=n.duration},r.attach2Char=function(t){this.target=t,t.buffs.add(this),this.staticInfo.buffType==a.AttrChange&&t.refreshAttr(),this.staticInfo.buffType==a.Status&&t.refreshBuffStatus()},r.removeFromTarget=function(){var t=this.target;t.buffs.delete(this);for(var n,r=e(this.children);!(n=r()).done;){n.value.removeFromTarget()}this.staticInfo.buffType==a.Status&&t.refreshBuffStatus(),this.staticInfo.buffType==a.AttrChange&&t.refreshAttr(),t.refreshBuffIcon()},r.showBuffName=function(){f.ins.curScene.floatTextManager.makeBuffNameFloat(this.staticInfo.name,this.target)},r.release=function(){this.caster=null,this.target=null,this.children=[]},n(t,[{key:"enable",get:function(){return!this.staticInfo.enableDudgeFunc||this.staticInfo.enableDudgeFunc(this)}}]),t}()),t("BuffDurationType",function(t){return t[t.Phase=0]="Phase",t[t.ATK=1]="ATK",t}({})),t("TriggerTimeType",function(t){return t[t.HpChange=0]="HpChange",t[t.BuffAdd=1]="BuffAdd",t[t.BuffRemove=2]="BuffRemove",t[t.AfterMove=3]="AfterMove",t[t.AfterAction=4]="AfterAction",t[t.BeforeAction=5]="BeforeAction",t[t.AfterATK=6]="AfterATK",t[t.AfterKill=7]="AfterKill",t}({}));var a=t("BuffType",function(t){return t[t.Trigger=0]="Trigger",t[t.AttrChange=1]="AttrChange",t[t.Status=2]="Status",t}({}));t("BuffStatus",function(t){return t[t.Dizz=0]="Dizz",t[t.Stand=1]="Stand",t[t.Slient=2]="Slient",t[t.AvoidInjury=3]="AvoidInjury",t}({}));r._RF.pop()}}}));

System.register("chunks:///_virtual/BuffStaticConfig.ts",["cc","./Buff.ts","./DataType.ts"],(function(e){var i,r,t,n,a;return{setters:[function(e){i=e.cclegacy},function(e){r=e.BuffDurationType,t=e.BuffType,n=e.TriggerTimeType},function(e){a=e.DT}],execute:function(){i._RF.push({},"a8222jkUAxPZZA3kmWwYdTy","BuffStaticConfig",void 0);e("BFSC",[{buffId:0,duration:1,durationType:r.ATK,name:"攻击+500%",buffType:t.AttrChange,attrPercAdd:{atk:5},isShowInPanel:!0,isDebuff:!1,description:"攻击提升500%"},{buffId:1,duration:3,durationType:r.Phase,name:"防御+700",buffType:t.AttrChange,attrNumAdd:{def:700},isShowInPanel:!0,isDebuff:!1,description:"防御提升700"},{buffId:2,duration:0,durationType:r.Phase,name:"协击",isPassiveSkill:!0,buffType:t.Trigger,triggerSkillCfgId:10,skillTriggerTime:n.AfterATK,isShowInPanel:!0,isDebuff:!1,description:"当队友发生攻击时，对攻击目标发起一次普通攻击",skillTriggerDudgeFunc:function(e,i){return!(e.target.camp!=i.caster.camp||!i.target.alive||e.target==i.caster)}},{buffId:3,duration:0,durationType:r.Phase,name:"越战越勇",isPassiveSkill:!0,buffType:t.Trigger,triggerSkillCfgId:11,skillTriggerTime:n.AfterKill,isShowInPanel:!0,isDebuff:!1,description:"击杀时，增加100%攻击力，持续3回合",skillTriggerDudgeFunc:function(e,i){return e.target==i.caster}},{buffId:4,duration:3,durationType:r.Phase,name:"攻击+100%",buffType:t.AttrChange,attrPercAdd:{atk:1},isShowInPanel:!0,isDebuff:!1,description:"攻击提升100%"},{buffId:5,duration:0,durationType:r.Phase,name:"借机攻击",isPassiveSkill:!0,buffType:t.Trigger,triggerSkillCfgId:15,skillTriggerTime:n.BeforeAction,isShowInPanel:!0,isDebuff:!1,description:"身边有敌方要移动前，对其发动一次攻击",skillTriggerDudgeFunc:function(e,i){if(i.eventType!=a.MOVEEVT)return!1;var r=i.char;return r.camp!=e.target.camp&&1==r.mapDisTo(e.target)}}]);i._RF.pop()}}}));

System.register("chunks:///_virtual/CharStaticConfig.ts",["cc","./AIActionConfig.ts"],(function(e){var a,r;return{setters:[function(e){a=e.cclegacy},function(e){r=e.AIActions}],execute:function(){a._RF.push({},"f0643UHkbBBj5yj0FeIkdi1","CharStaticConfig",void 0);e("CharSC",[{charId:0,charName:"甄宓",spriteName:"0732_zhenshi",occupation:2,atk:120,def:20,maxHp:300,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[2]},{charId:1,charName:"士兵",spriteName:"0670_兵士_1",AIActionStrategy:r.AIBase,occupation:1,atk:100,def:20,maxHp:200,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:130,skillIds:[13],passiveSkillIds:[2,5]},{charId:2,charName:"张郃",spriteName:"0025_张郃_1",dependResouces:["0670_兵士_1"],AIActionStrategy:r.AIBossTest,occupation:1,atk:200,def:20,maxHp:3e3,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[0,3,4,5,12]},{charId:3,charName:"貂蝉",spriteName:"0566_貂蝉_1",occupation:2,atk:120,def:20,maxHp:200,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[2],passiveSkillIds:[2,3]},{charId:4,charName:"大乔",spriteName:"0567_大乔_1",occupation:2,atk:150,def:20,maxHp:200,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[2,8,9]},{charId:5,charName:"马云騄",spriteName:"0784_马云騄_1",occupation:1,atk:150,def:30,maxHp:450,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[0,1,6]},{charId:6,charName:"吕玲绮",spriteName:"0785_吕玲绮_1",occupation:1,atk:70,def:35,maxHp:800,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[0,1]},{charId:7,charName:"弓箭手",spriteName:"弓",AIActionStrategy:r.AIBase,occupation:2,atk:100,def:20,maxHp:200,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:90,skillIds:[14]},{charId:8,charName:"吕玲绮",spriteName:"0785_吕玲绮_1",occupation:1,atk:100,def:30,maxHp:450,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[0,1,6]},{charId:9,charName:"孙尚香",spriteName:"1538_孙尚香_1",occupation:1,atk:100,def:30,maxHp:450,harmIncrease:0,harmDecrease:0,injureIncrease:0,injureDecrease:0,critPerc:0,critRatio:1,startAp:100,skillIds:[0,1,6]}]);a._RF.pop()}}}));

System.register("chunks:///_virtual/ChinaColor.ts",["cc"],(function(n){var i,a;return{setters:[function(n){i=n.cclegacy,a=n.color}],execute:function(){i._RF.push({},"f21558HVFNOjKXgMsx125P8","ChinaColor",void 0);var u=n("ChinaColor",function(){function n(){}return n.getOtherAlphaOfColor=function(n,i){return a(n.r,n.g,n.b,i)},n}());u.YaQing=a(66,75,80),u.DaiLan=a(65,80,101),u.Li=a(118,102,77),u.AiQing=a(163,226,197),u.TuoSe=a(168,132,98),u.YanZhi=a(157,41,50),u.ZhuQing=a(157,41,50),u.Yanzhi2=a(120,146,98),u.YaBai=a(239,222,176),u.WanWan=a(169,129,117),u.ChaBai=a(243,248,241),u.Chi=a(195,39,43),u.Tan=a(179,109,97),u.ShuiLv=a(212,242,232),u.YueBai=a(215,236,241),u.QiuXiangSe=a(217,182,18),u.YinZhu=a(199,62,58),u.QingHui=a(43,51,62),u.BaoShiLv=a(65,174,60),u.JiZong=a(222,118,34),u.WanShouJuHuang=a(251,139,5),i._RF.pop()}}}));

System.register("chunks:///_virtual/DataType.ts",["cc"],(function(E){var C;return{setters:[function(E){C=E.cclegacy}],execute:function(){C._RF.push({},"10b6cbZxVhBzKy1YWVSrsU1","DataType",void 0);E("DT",{CURSTAGEINFO:"CURSTAGEINFO",GSI:"GuideStepId",MOVEEVT:"MOVEEVT",SKILLEVT:"SKILLEVT",SLGBattleMode:"SLGBattleMode",RoughCharRunningInfos:"RoughCharRunningInfos"}),E("MT",{OS:"onshare",SLGEVTQUEND:"SLGEVTQUEND",BFTT:"BuffTriggerTime",SKILLFUNCEND:"SKILLFUNCEND",SELECTEDCHARAPCHANGE:"SELECTEDCHARAPCHANGE",CURENEMYACTIONDONE:"CURENEMYACTIONDONE",SELECTEDCHARCDCHANGE:"SELECTEDCHARCDCHANGE",CHARDEAD:"CHARDEAD",BeforeEvtAction:"BeforeEvtAction"});C._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/FloatText.ts",["cc"],(function(t){var e,o,i,n,l,s;return{setters:[function(t){e=t.cclegacy,o=t.Node,i=t.Label,n=t.LabelOutline,l=t.Color,s=t.Vec3}],execute:function(){e._RF.push({},"7ff96peNSJMnqU91vNzQiMz","FloatText",void 0);t("FloatText",(function(){this.node=void 0,this.label=void 0,this.outline=void 0,this.node=new o("FloatDamage"),this.label=this.node.addComponent(i),this.outline=this.node.addComponent(n),this.outline.color=l.BLACK,this.outline.width=2,this.label.isBold=!0,this.node.setScale(new s(.25,.25,1)),this.node.layer=1}));e._RF.pop()}}}));

System.register("chunks:///_virtual/FloatTextManager.ts",["cc","./FloatText.ts","./ObjPool.ts"],(function(t){var e,o,a,n,l,i,r;return{setters:[function(t){e=t.cclegacy,o=t.find,a=t.Color,n=t.tween,l=t.Vec3},function(t){i=t.FloatText},function(t){r=t.MyObjPool}],execute:function(){e._RF.push({},"8d5e2E9KD5F7LZGorCsa2o0","FloatTextManager",void 0);t("FloatTextManager",function(){function t(){this._floatTextPool=new r,this._floatTextLayerNode=void 0}var e=t.prototype;return e.init=function(){this._floatTextLayerNode=o("TiledMapCanvas/DamageFloatLayer"),this._floatTextPool.init(null,null,t.genFloatText)},t.genFloatText=function(){return new i},e._getFloatText=function(){return this._floatTextPool.get()},e.makeBuffNameFloat=function(t,e){var o=this,i=this._getFloatText();i.label.fontSize=40,i.label.lineHeight=40,i.label.color=a.WHITE,i.label.string=t,this._floatTextLayerNode.addChild(i.node),i.node.setPosition(e.node.getPosition().add3f(10,10,0)),n().target(i.node).by(1,{position:new l(0,30,0)},{easing:"expoOut"}).call((function(){i.node.removeFromParent(),o._floatTextPool.put(i)})).start()},e.makeDamageFloat=function(t,e,o){var i=this;void 0===o&&(o=!1);var r=this._getFloatText();o?(r.label.fontSize=80,r.label.lineHeight=80):(r.label.fontSize=40,r.label.lineHeight=40),r.label.color=t>0?a.GREEN:o?a.YELLOW:a.RED;var s=((t=Math.ceil(t))>0?"+":"")+t;r.label.string=s,this._floatTextLayerNode.addChild(r.node),r.node.setPosition(e.node.getPosition().add3f(10,10,0)),n().target(r.node).by(1,{position:new l(0,30,0)},{easing:"expoOut"}).call((function(){r.node.removeFromParent(),i._floatTextPool.put(r)})).start()},e.release=function(){this._floatTextPool.release()},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/GameData.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e;return{setters:[function(n){t=n.createClass},function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"3a258wKggtAJZ74HoKhSt/A","GameData",void 0),n("GameData",function(){function n(){}return t(n,null,[{key:"ins",get:function(){return null==this._ins&&(this._ins=new n),this._ins}}]),n}())._ins=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/GameRoot.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./MessageManager.ts","./SceneManager.ts","./StartScene.ts"],(function(e){var t,n,a,s,r,o,i,c,u,f,m,h,g;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass,a=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){r=e.cclegacy,o=e._decorator,i=e.director,c=e.find,u=e.Component},function(e){f=e.GameData},function(e){m=e.MessageManager},function(e){h=e.SceneManager},function(e){g=e.StartScene}],execute:function(){var d,l;r._RF.push({},"fbc97TeEORC/7efZo4uXMh/","GameRoot",void 0);var p=o.ccclass;o.property,e("GameRoot",p("GameRoot")(((l=function(e){function r(){for(var t,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(t=e.call.apply(e,[this].concat(a))||this).managers=[h.ins,m.ins],t.gamedata=f.ins,t._isSystemLoadEnd=!1,t}t(r,e);var o=r.prototype;return o.start=function(){i.addPersistRootNode(this.node),this.loadSystems()},o.loadSystems=function(){var e=a(s().mark((function e(){var t,n,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],n=0;n<this.managers.length;n++)t.push(this.managers[n].preLoadAsync());return e.next=4,Promise.all(t);case 4:for(a=0;a<this.managers.length;a++)this.managers[a].init();h.ins.setNewScene(new g),this._isSystemLoadEnd=!0;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.update=function(e){if(this._isSystemLoadEnd)for(var t=0;t<this.managers.length;t++)this.managers[t].update(e)},n(r,null,[{key:"ins",get:function(){if(r._ins)return r._ins;var e=c("GameRoot").getComponent(r);return this._ins=e,e}}]),r}(u))._ins=void 0,d=l))||d);r._RF.pop()}}}));

System.register("chunks:///_virtual/GuideCommonCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GuideSystem.ts"],(function(e){var t,n,i,o,r,c;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,o=e.find,r=e.Component},function(e){c=e.GuideSystem}],execute:function(){var a;n._RF.push({},"0d547mkKkJFO6TMG/jFVmxY","GuideCommonCtrl",void 0);var u=i.ccclass;i.property,e("GuideCommonCtrl",u("GuideCommonCtrl")(a=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._curPageId=1,t}t(n,e);var i=n.prototype;return i.guideEnd=function(){c.ins.onGuideComplete()},i.nextPage=function(){var e=this.node.getChildByName("Page"+this._curPageId);this._curPageId+=1,this.node.getChildByName("Page"+this._curPageId).active=!0,e.active=!1},i.prevPage=function(){var e=this.node.getChildByName("Page"+this._curPageId);this._curPageId-=1,this.node.getChildByName("Page"+this._curPageId).active=!0,e.active=!1},i.clickAndComplete=function(e,t){console.log(t);var n=t.split(","),i=n[0],r=n[1],a=n[2];o(i).getComponent(r)[a](),c.ins.onGuideComplete()},n}(r))||a);n._RF.pop()}}}));

System.register("chunks:///_virtual/GuideConfig.ts",["cc"],(function(e){var i;return{setters:[function(e){i=e.cclegacy}],execute:function(){i._RF.push({},"ffc42gGpshFd6PaJXgUyE2j","GuideConfig",void 0);e("GuideStepConfig",[]);i._RF.pop()}}}));

System.register("chunks:///_virtual/GuideSystem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DataType.ts","./SDK.ts","./GameData.ts","./IManager.ts"],(function(e){var i,t,n,s,u,d,a,o,r,f,G,c;return{setters:[function(e){i=e.inheritsLoose,t=e.createClass},function(e){n=e.cclegacy,s=e.resources,u=e.Prefab,d=e.find,a=e.Button,o=e.instantiate},function(e){r=e.DT},function(e){f=e.SDK},function(e){G=e.GameData},function(e){c=e.IManager}],execute:function(){n._RF.push({},"3dafcnt1t9Jw7O6yXZmddoN","GuideSystem",void 0),e("GuideSystem",function(e){function n(){var i;return(i=e.call(this)||this)._curGuidePrefab=void 0,i.GuideStepsConfig=void 0,i.isInGuide=!1,i.GuideLayerNode=void 0,i.guidePrefabNode=void 0,i}i(n,e);var c=n.prototype;return c.init=function(){var e=f.ins.getStorageSync(r.GSI);e||(e=0),G.ins[r.GSI]=e},c.setGuideStepsConfig=function(e){if(this.GuideStepsConfig=e,this._hasNextGuideSep()){var i=G.ins[r.GSI];s.preload(this.GuideStepsConfig[i].prefabName,u)}},c.onGuideComplete=function(){this.guidePrefabNode.destroy(),this.GuideLayerNode.active=!1,this.isInGuide=!1;var e=G.ins[r.GSI]+1;G.ins[r.GSI]=e,console.log("教程已完成，当前教程ID为"+e),f.ins.setStorage({key:r.GSI,data:e}),this._curGuidePrefab.decRef(),this._curGuidePrefab=null,this._hasNextGuideSep()&&s.preload(this.GuideStepsConfig[e].prefabName,u)},c._hasNextGuideSep=function(){return!!this.GuideStepsConfig&&G.ins[r.GSI]<this.GuideStepsConfig.length},c.update=function(e){var i=this;if(this.GuideStepsConfig&&this._hasNextGuideSep()&&!this.isInGuide){var t=G.ins[r.GSI];this.GuideStepsConfig[t].isGuideOccur()&&(this.isInGuide=!0,this.GuideLayerNode=d("Canvas/GuideLayer"),this.GuideLayerNode.active=!0,this.GuideLayerNode.getComponent(a).enabled=!0,s.load(this.GuideStepsConfig[t].prefabName,u,(function(e,t){t.addRef(),i._curGuidePrefab=t,i.guidePrefabNode=o(i._curGuidePrefab),i.GuideLayerNode.addChild(i.guidePrefabNode),i.GuideLayerNode.getComponent(a).enabled=!1})))}},t(n,null,[{key:"ins",get:function(){return null==this._ins&&(this._ins=new n),this._ins}}]),n}(c))._ins=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/IManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var t,e,r;return{setters:[function(n){t=n.asyncToGenerator,e=n.regeneratorRuntime},function(n){r=n.cclegacy}],execute:function(){r._RF.push({},"33d69DYbK9OSK7gEY6bzTfu","IManager",void 0);n("IManager",function(){function n(){}var r=n.prototype;return r.preLoadAsync=function(){var n=t(e().mark((function n(){return e().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r.init=function(){},r.update=function(n){},n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/IScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SDK.ts"],(function(n){var e,t,r,i;return{setters:[function(n){e=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){r=n.cclegacy},function(n){i=n.SDK}],execute:function(){r._RF.push({},"f4dd5C81lNH4aFc343Oz4xF","IScene",void 0);n("IScene",function(){function n(n){this.isEndLoad=!1,this.sceneName=void 0,this.sceneName=n}var r=n.prototype;return r.init=function(){},r.load=function(){var n=e(t().mark((function n(){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.preload();case 2:this.init(),this.isEndLoad=!0,i.ins.call("hideLoading");case 5:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),r.update=function(n){},r.preload=function(){var n=e(t().mark((function n(){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r.release=function(){},n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/ISLGBattleMapState.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"c2904kK2mdDeauPbNxNL8Gx","ISLGBattleMapState",void 0);t("ISLGBattleMapState",function(){function t(){}var e=t.prototype;return e.preSet=function(){},e.clear=function(){},e.release=function(){},t}()),t("SLGMAPSTATE",function(t){return t[t.NORMAL=0]="NORMAL",t[t.TILESELECT=1]="TILESELECT",t[t.CHARSELECT=2]="CHARSELECT",t[t.MOVE=3]="MOVE",t[t.SKILLCAST=4]="SKILLCAST",t[t.SKILLPRESELECT=5]="SKILLPRESELECT",t}({}));e._RF.pop()}}}));

System.register("chunks:///_virtual/ISLGGameMode.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,r;return{setters:[function(n){e=n.asyncToGenerator,t=n.regeneratorRuntime},function(n){r=n.cclegacy}],execute:function(){r._RF.push({},"715e0h0T4pOFbiLgSbfpBfS","ISLGGameMode",void 0);n("ISLGGameMode",function(){function n(){this.stageRunningInfo=void 0}var r=n.prototype;return r.preload=function(){var n=e(t().mark((function n(){return t().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),r.init=function(){},r.release=function(){},n}());r._RF.pop()}}}));

System.register("chunks:///_virtual/LoadDataFromLocal.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./SDK.ts"],(function(e){var t,n,r,a,o;return{setters:[function(e){t=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){r=e.cclegacy},function(e){a=e.GameData},function(e){o=e.SDK}],execute:function(){function u(){return(u=t(n().mark((function e(t,r){var u,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=-1),u=a.ins[t]){e.next=7;break}return console.log("没有在内存中找到"+t+"，从storage中查找"),e.next=6,o.ins.getStorage(t);case 6:u=e.sent;case 7:if(u){e.next=10;break}return console.log("没有storage中找到"+t+"，返回null"),e.abrupt("return",null);case 10:if(!(r>0)){e.next=16;break}if(s=Date.now(),!(s-u.saveTime>1e3*r)){e.next=16;break}return console.log(t+"数据已过期，返回null"),e.abrupt("return",null);case 16:return a.ins[t]=u,console.log("从本地或内存读取到未过期的"+t+"，写入GameData"),e.abrupt("return",u);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e("getDataFromRamOrDisk",(function(e,t){return u.apply(this,arguments)})),r._RF.push({},"1a5aao2JyFFC7J36/oCzUrb","LoadDataFromLocal",void 0),r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./AsyncLoad.ts","./AudioEffectController.ts","./ChinaColor.ts","./BaseToast.ts","./Toast.ts","./GuideCommonCtrl.ts","./LoadDataFromLocal.ts","./MyUtil.ts","./ObjPool.ts","./OnTouchToClose.ts","./Queue.ts","./GameData.ts","./GameRoot.ts","./GuideSystem.ts","./IManager.ts","./IScene.ts","./MessageManager.ts","./SceneManager.ts","./AIActionConfig.ts","./BuffStaticConfig.ts","./CharStaticConfig.ts","./DataType.ts","./GuideConfig.ts","./SkillStaticConfig.ts","./SkillTargetSelectFuncs.ts","./StageConfig.ts","./StaticConfig.ts","./SDK.ts","./SDKAdapterBase.ts","./WXSDKAdapter.ts","./MainScene.ts","./MainUIManager.ts","./Buff.ts","./FloatText.ts","./AIManager.ts","./FloatTextManager.ts","./SLGBattleCharManager.ts","./SLGBattleEvtQueueManager.ts","./SLGBattleMapManager.ts","./SLGBattlePhaseManager.ts","./SLGBattleUIManager.ts","./SLGBuffManager.ts","./SLGStageManager.ts","./SLGTileManager.ts","./ISLGGameMode.ts","./SLGNormalGameMode.ts","./SLGRoughGameMode.ts","./RoughCharSelectSprite.ts","./SLGBattleAttr.ts","./SLGBattleChar.ts","./ISLGBattleMapState.ts","./SLGBattleCharMoveState.ts","./SLGBattleCharSelectState.ts","./SLGBattleNormalState.ts","./SLGBattleSkillCastState.ts","./SLGBattleSkillPreSelectState.ts","./SLGBattleTileSelectState.ts","./SLGBattleScene.ts","./SLGBattleSkill.ts","./SLGBattleSkillButton.ts","./SLGMapIndicator.ts","./SLGRoughGroup.ts","./SLGUIInfoGroup.ts","./StartScene.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MainScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./IScene.ts","./MainUIManager.ts"],(function(n){var e,t,r,a,i,c,o;return{setters:[function(n){e=n.inheritsLoose,t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){a=n.cclegacy,i=n._decorator},function(n){c=n.IScene},function(n){o=n.MainUIManager}],execute:function(){var u;a._RF.push({},"0fa8bi1ibhA54cUiq/GxXod","MainScene",void 0);var s=i.ccclass;i.property,n("MainScene",s("MainScene")(u=function(n){e(i,n);var a=i.prototype;function i(){var e;return(e=n.call(this,"Main")||this)._UIManager=new o,e}return a.init=function(){this._UIManager.init()},a.update=function(n){},a.release=function(){this._UIManager.release()},a.preload=function(){var n=t(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),i}(c))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/MainUIManager.ts",["cc","./SceneManager.ts","./SLGBattleScene.ts","./GameData.ts","./DataType.ts","./StaticConfig.ts"],(function(t){var n,o,e,a,i,s,u,d,r;return{setters:[function(t){n=t.cclegacy,o=t.find,e=t.Node},function(t){a=t.SceneManager},function(t){i=t.SLGGameMode,s=t.SLGBattleScene},function(t){u=t.GameData},function(t){d=t.DT},function(t){r=t.GSC}],execute:function(){n._RF.push({},"f5eed938mNEmKTIeyXA+MnE","MainUIManager",void 0);t("MainUIManager",function(){function t(){this._normalModeButtonNode=void 0,this._roughModeButtonNode=void 0}var n=t.prototype;return n.init=function(){this._normalModeButtonNode=o("Canvas/NormalMode"),this._roughModeButtonNode=o("Canvas/RoughMode"),this._normalModeButtonNode.on(e.EventType.TOUCH_END,this._onNormalModeButtonTap,this),this._roughModeButtonNode.on(e.EventType.TOUCH_END,this._onRoughModeButtonTap,this)},n._onRoughModeButtonTap=function(){u.ins[d.SLGBattleMode]=i.Rough;var t=Object.assign({},r.CHARSC[5]),n=Object.assign({},r.CHARSC[0]);n.skillIds=[2],n.passiveSkillIds=[],t.skillIds=[0],t.passiveSkillIds=[],u.ins[d.RoughCharRunningInfos]=[n,t],a.ins.setNewScene(new s)},n._onNormalModeButtonTap=function(){u.ins[d.SLGBattleMode]=i.Normal,a.ins.setNewScene(new s)},n.release=function(){this._normalModeButtonNode.off(e.EventType.TOUCH_END,this._onNormalModeButtonTap,this),this._roughModeButtonNode.off(e.EventType.TOUCH_END,this._onRoughModeButtonTap,this)},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/MessageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./IManager.ts"],(function(e){var n,t,s,i;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass},function(e){s=e.cclegacy},function(e){i=e.IManager}],execute:function(){s._RF.push({},"ab39eQwi89HdYuxBMgonxsK","MessageManager",void 0),e("MessageManager",function(e){function s(){var n;return(n=e.call(this)||this)._listeners=new Map,n}n(s,e);var i=s.prototype;return i.removeListener=function(e,n,t){void 0===t&&(t=null);var s=this._listeners.get(e);if(null!=s)for(var i=0;i<s.length;i++){var r=s[i];null!=r&&r[0]==n&&r[1]==t&&(s[i]=null)}},i.addListener=function(e,n,t){void 0===t&&(t=null),null==this._listeners.get(e)&&this._listeners.set(e,[]);for(var s=this._listeners.get(e),i=0;i<s.length;i++){if(null==s[i])return void(s[i]=[n,t])}this._listeners.get(e).push([n,t])},i.addListenerOnlyOne=function(e,n,t){void 0===t&&(t=null);var s=this._listeners.get(e);if(null!=s){for(var i=0;i<s.length;i++){var r=s[i];if(null!=r&&r[0]==n&&r[1]==t)return}this.addListener(e,n,t)}else this.addListener(e,n,t)},i.removeAllListener=function(e){this._listeners.delete(e)},i.sendMessage=function(e,n){void 0===n&&(n=null);var t=this._listeners.get(e);if(t)for(var s=0;s<t.length;s++)if(null!=t[s]){var i=t[s][0],r=t[s][1];i.call(r,n)}},i.clearListeners=function(){this._listeners.clear()},t(s,null,[{key:"ins",get:function(){return null==this._ins&&(this._ins=new s),this._ins}}]),s}(i))._ins=void 0,s._RF.pop()}}}));

System.register("chunks:///_virtual/MyUtil.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"5cc8clKUy9KbamYdWCaWBP6","MyUtil",void 0);t("MyUtil",function(){function t(){}return t.removeObjFromArray=function(t,n){var r=t.indexOf(n);return r>=0&&(t.splice(r,1),!0)},t.contains=function(t,n){return t.indexOf(n)>=0},t.getRandomArray=function(t){for(var n=[],r=t.length;r>0;){var e=Math.floor(Math.random()*r);e==r&&(e-=1),n.push(t.splice(e,1)[0]),r-=1}return n},t.pointDistance=function(t,n){var r=t[0]-n[0],e=t[1]-n[1];return Math.sqrt(r*r+e*e)},t.getRad=function(n,r){var e=t.pointDistance(n,r),o=r[1]-n[1],a=(r[0]-n[0])/e,c=Math.acos(o/e);return a>0?c:-c},t.isNumEqual=function(t,n,r){return void 0===r&&(r=3),Math.abs(t-n)<r},t.degNormalize=function(t){return(t%=360)>180?t-360:t<-180?t+360:t},t.clamp=function(t,n,r){return t<n?n:t>r?r:t},t.shuffle=function(t){for(var n=t.length;n;){var r=Math.floor(Math.random()*n--),e=t[n];t[n]=t[r],t[r]=e}},t.getClassName=function(t){return t.constructor.toString().match(/\w+/g)[1]},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/ObjPool.ts",["cc"],(function(n){var t,e;return{setters:[function(n){t=n.cclegacy,e=n.instantiate}],execute:function(){t._RF.push({},"77a7d3mKGhM856XVx9oyY5L","ObjPool",void 0);n("MyObjPool",function(){function n(){this._pool=[],this._basePrefabOrNode=void 0,this._genFunc=void 0}var t=n.prototype;return t._isUseFuncCreate=function(){return null!=this._genFunc},t.getObjs=function(){return this._pool},t.init=function(n,t,e){void 0===t&&(t=null),void 0===e&&(e=null),null==e?this._basePrefabOrNode=t||n:this._genFunc=e},t.get=function(){return this._pool.length>0?this._pool.pop():this._isUseFuncCreate()?this._genFunc():e(this._basePrefabOrNode)},t.put=function(n){this._pool.push(n)},t.release=function(){this._basePrefabOrNode=null,this._genFunc=null,this._pool=null},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/OnTouchToClose.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var n,t,e,c,i;return{setters:[function(o){n=o.inheritsLoose},function(o){t=o.cclegacy,e=o._decorator,c=o.Animation,i=o.Component}],execute:function(){var s;t._RF.push({},"d0e47lQjqtJWYpig5UmQnLR","OnTouchToClose",void 0);var r=e.ccclass;e.property,o("OnTouchToClose",r("OnTouchToClose")(s=function(o){function t(){return o.apply(this,arguments)||this}n(t,o);var e=t.prototype;return e.close=function(){this.node.active=!1},e.show=function(){this.node.active=!0;var o=this.getComponent(c);o&&o.play()},t}(i))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/Queue.ts",["cc"],(function(t){var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"7f51bTevQJH/KhjBRQJp4on","Queue",void 0);var e=function(t,i){void 0===i&&(i=null),this.value=t,this.next=i};t("Queue",function(){function t(){this.head=void 0,this.tail=void 0,this.size=0}var i=t.prototype;return i.enqueue=function(t){var i=new e(t);this.isEmpty()?(this.head=i,this.tail=i):(this.tail.next=i,this.tail=i),this.size++},i.push=function(t){var i=new e(t);this.isEmpty()?(this.head=i,this.tail=i):(i.next=this.head,this.head=i),this.size++},i.dequeue=function(){if(this.isEmpty())return null;var t=this.head.value;return this.head=this.head.next,null===this.head&&(this.tail=null),this.size--,t},i.isEmpty=function(){return 0===this.size},i.peek=function(){return this.isEmpty()?null:this.head.value},i.clear=function(){this.head=null,this.tail=null,this.size=0},i.getSize=function(){return this.size},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/RoughCharSelectSprite.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChinaColor.ts","./SceneManager.ts","./GameData.ts","./DataType.ts"],(function(e){var t,n,i,r,o,a,c,s,h,p,l,u,g,f,S,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,c=e._decorator,s=e.CCInteger,h=e.Sprite,p=e.Node,l=e.Color,u=e.Component},function(e){g=e.ChinaColor},function(e){f=e.SceneManager},function(e){S=e.GameData},function(e){d=e.DT}],execute:function(){var C,v,_,y,D;a._RF.push({},"04ac0saZitO2pQ6nhqIkYbD","RoughCharSelectSprite",void 0);var I=c.ccclass,T=c.property;e("RoughCharSelectSprite",(C=I("RoughCharSelectSprite"),v=T({type:s}),C((D=t((y=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this)._bgSprite=void 0,t._headSprite=void 0,i(t,"charIndex",D,r(t)),t.isSelect=!1,t}n(t,e);var a=t.prototype;return a.init=function(){this._bgSprite=this.getComponent(h),this._headSprite=this.node.children[0].getComponent(h);var e=f.ins.curScene;if(this.charIndex<S.ins[d.RoughCharRunningInfos].length){var t=S.ins[d.RoughCharRunningInfos][this.charIndex].spriteName;this._headSprite.spriteFrame=e.resourceDict.get(t)}else this.node.active=!1;this.node.on(p.EventType.TOUCH_END,this._onTap,this)},a.select=function(){this._bgSprite.color=g.JiZong,this.isSelect=!0},a.unSelect=function(){this._bgSprite.color=l.WHITE,this.isSelect=!1},a._onTap=function(){for(var e,n=o(this.node.parent.children);!(e=n()).done;){e.value.getComponent(t).unSelect()}this.select()},a.release=function(){this.node.off(p.EventType.TOUCH_END,this._onTap,this)},t}(u)).prototype,"charIndex",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=y))||_));a._RF.pop()}}}));

System.register("chunks:///_virtual/SceneManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SDK.ts","./IManager.ts","./MessageManager.ts"],(function(e){var n,t,i,r,s,c,a,u,o,h;return{setters:[function(e){n=e.inheritsLoose,t=e.createClass,i=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e.view,a=e.director},function(e){u=e.SDK},function(e){o=e.IManager},function(e){h=e.MessageManager}],execute:function(){s._RF.push({},"1950fcSw+JMbJQO3rJkRFBS","SceneManager",void 0),e("SceneManager",function(e){function s(){var n;return(n=e.call(this)||this).gameWidth=void 0,n.gameHeight=void 0,n.curScene=void 0,n}n(s,e);var o=s.prototype;return o.init=function(){var e=c.getVisibleSize();this.gameWidth=e.width,this.gameHeight=e.height},o.update=function(e){this.curScene&&this.curScene.isEndLoad&&this.curScene.update(e)},o.setNewScene=function(){var e=i(r().mark((function e(n){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.ins.call("showLoading",{title:"加载中"}),h.ins.clearListeners(),this.curScene&&this.curScene.release(),this.curScene=n,a.loadScene(n.sceneName,(function(){n.load()}));case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}(),t(s,null,[{key:"ins",get:function(){return null==this._ins&&(this._ins=new s),this._ins}}]),s}(o))._ins=void 0,s._RF.pop()}}}));

System.register("chunks:///_virtual/SDK.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SDKAdapterBase.ts","./WXSDKAdapter.ts"],(function(t){var e,n,i,r;return{setters:[function(t){e=t.createClass},function(t){n=t.cclegacy},function(t){i=t.SDKAdapterBase},function(t){r=t.WXSDKAdapter}],execute:function(){n._RF.push({},"20f9fjR0GBIxZmSz0eS2SfV","SDK",void 0),t("SDK",function(){function t(){}return e(t,null,[{key:"ins",get:function(){return this._SDKAdapter||(window.wx||window["其他平台"]?this._SDKAdapter=new r:this._SDKAdapter=new i,this._SDKAdapter.init()),this._SDKAdapter}}]),t}())._SDKAdapter=void 0,n._RF.pop()}}}));

System.register("chunks:///_virtual/SDKAdapterBase.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Toast.ts","./BaseToast.ts"],(function(t){var r,e,n,o,a;return{setters:[function(t){r=t.asyncToGenerator,e=t.regeneratorRuntime},function(t){n=t.cclegacy},function(t){o=t.Toast},function(t){a=t.Gravity}],execute:function(){n._RF.push({},"562e5GcLDhOoKv2d9loQc4q","SDKAdapterBase",void 0);t("SDKAdapterBase",function(){function t(){}var n=t.prototype;return n.init=function(){},n.call=function(t){if(this[t]){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];this[t].apply(this,e)}else console.log("无SDK环境下调用API接口"+t)},n.postMessageToOpenContext=function(t){},n.getDataVersion=function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",0);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n.callCloudFunction=function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n.getWorldRankDataFromServer=function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[]);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n.getObj=function(t){return this[t]?this[t]:(console.log("无SDK环境下调用SDK GetObj "+t),null)},n.setUserCloudStorage=function(t){console.log("ISDKAdapter setUserCloudStorage")},n.setStorage=function(t){localStorage.setItem(t.key,JSON.stringify(t.data))},n.getStorageSync=function(t){var r=localStorage.getItem(t);return null==r?null:JSON.parse(r)},n.getStorage=function(){var t=r(e().mark((function t(r){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getStorageSync(r));case 1:case"end":return t.stop()}}),t,this)})));return function(r){return t.apply(this,arguments)}}(),n.loadSubPackage=function(t,r){return null},n.getProvRankDataFromServer=function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[{provName:"北京市",rank:1,totalScore:123456789},{provName:"江西省",rank:2,totalScore:1325},{provName:"天津市",rank:3,totalScore:0},{provName:"河北省",rank:4,totalScore:0},{provName:"山西省",rank:5,totalScore:0},{provName:"内蒙古自治区",rank:6,totalScore:0}]);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n.readFileFromCloud=function(){var t=r(e().mark((function t(r,n,o){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","");case 3:case"end":return t.stop()}}),t)})));return function(r,e,n){return t.apply(this,arguments)}}(),n.showToast=function(t){var r=t.title,e=t.duration;o.show(r,e/1e3,{gravity:a.TOP,textSize:40,lineHeight:4})},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/SkillStaticConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SLGBattleSkill.ts","./SLGBattleChar.ts","./MessageManager.ts","./DataType.ts","./SceneManager.ts","./Queue.ts","./SLGTileManager.ts","./SkillTargetSelectFuncs.ts","./SLGBattleEvtQueueManager.ts"],(function(e){var a,t,n,s,c,l,r,i,o,f,g,p,u,T,d;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy,n=e.tween,s=e.Vec3},function(e){c=e.SkillSelectOperateType,l=e.SkillCanCastTileType,r=e.SkillEffectType},function(e){i=e.SLGBTCAMP},function(e){o=e.MessageManager},function(e){f=e.MT},function(e){g=e.SceneManager},function(e){p=e.Queue},function(e){u=e.SLGTileManager},function(e){T=e.STSF},function(e){d=e.SLGCharSkillCastEvent}],execute:function(){function C(e,a,t){var n=e*(a.attr.atk-t.attr.def);return n>1?n:1}function y(e){for(var t,c,l=e.params,r=e.caster,i=l.targetTileXY,p=g.ins.curScene,u=a(e.targetChars);!(c=u()).done;){var T=c.value;null!=T&&T.hpChange(-C(1,r,T))}var d=(t=p.tileManager).getPosByXY.apply(t,i),y=r.node.getPosition();p.charManager.charToTop(r),n().target(r.node).to(.05,{scale:new s(1.5,1.5,1)}).to(.1,{position:new s(d.x,d.y,0),scale:s.ONE}).to(.2,{position:y}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}t._RF.push({},"11022CpB2BAEYaNflcEX4u+","SkillStaticConfig",void 0);var S=e("SKSC",[{skillId:0,skillName:"近战普攻",effectRange:1,castRange:1,preCalRatio:1,isATK:!0,isNomalATK:!0,desc:"对敌人造成1倍伤害。",cd:1,apCost:20,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:y},{skillId:1,skillName:"重击",effectRange:1,castRange:1,preCalRatio:3,isATK:!0,isNomalATK:!1,desc:"对敌人造成3倍伤害。",cd:3,apCost:60,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:function(e){for(var t,c,l,r=e.params,i=e.caster,p=r.targetTileXY,u=g.ins.curScene,T=((t=u.charManager).getCharFromXY.apply(t,p),a(e.targetChars));!(l=T()).done;){var d=l.value;null!=d&&d.hpChange(-C(3,i,d))}var y=(c=u.tileManager).getPosByXY.apply(c,p),S=i.node.getPosition();u.charManager.charToTop(i),n().target(i.node).to(.05,{scale:new s(1.5,1.5,1)}).to(.1,{position:new s(y.x,y.y,0),scale:s.ONE}).to(.2,{position:S}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:2,skillName:"远程普攻",effectRange:1,castRange:5,preCalRatio:1,isATK:!0,isNomalATK:!0,desc:"对敌人造成1倍伤害。",cd:1,apCost:20,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:y},{skillId:3,skillName:"闪现攻击",effectRange:1,castRange:0,preCalRatio:1,isATK:!0,isNomalATK:!1,desc:"闪现到离自己最远的敌人附近，并对其造成1倍伤害。",cd:3,apCost:60,selectOperateType:c.AUTO,effectType:r.Oppo,getEffetTargetsFunc:function(e,t,n){for(var s,c,l=g.ins.curScene,r=0,i=a(l.charManager.charsOnStage);!(c=i()).done;){var o=c.value;if(o.alive&&o.camp!=e.camp){var f=o.mapDisTo(e);f>r&&(r=f,s=o)}}return[s]},castFunc:function(e){var a,t,c=g.ins.curScene,l=e.targetChars[0],r=e.caster,i=new p,T=new Set,d=l.tileX,y=l.tileY;for(i.enqueue(u.getIdByXY(d,y));i.size>0;){var S=u.getXYById(i.dequeue());if(d=S[0],y=S[1],T.add(u.getIdByXY(d,y)),!c.mapManager.hasChar(d,y)){t=[d,y];break}for(var N=0,h=[[d,y-1],[d,y+1],[d-1,y],[d+1,y]];N<h.length;N++){var M=h[N],A=M[0],v=M[1];if(c.tileManager.isXYInMap(A,v)){var m=u.getIdByXY(A,v);T.has(m)||i.enqueue(m)}}}c.charManager.charToTop(r),(a=c.charManager).charSetTo.apply(a,[r].concat(t)),l.hpChange(-C(1,r,l));var F=c.tileManager.getPosByXY(l.tileX,l.tileY),k=r.node.getPosition();n().target(r.node).to(.05,{scale:new s(1.5,1.5,1)}).to(.1,{position:new s(F.x,F.y,0),scale:s.ONE}).to(.2,{position:k}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:4,skillName:"怒吼",effectRange:1,castRange:1,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"提升自身500%攻击力，下一次攻击有效。",cd:3,apCost:60,selectOperateType:c.AUTO,effectType:r.Friend,getEffetTargetsFunc:T.SelectSelf,castFunc:function(e){var a=e.caster,t=g.ins.curScene,c=t.buffManager.newBuff(0,a);t.buffManager.attachBuff2Char(c,a),t.charManager.charToTop(a),n().target(a.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:5,skillName:"召唤",effectRange:1,castRange:1,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"身边召唤6名士兵。",cd:3,startCd:3,apCost:0,selectOperateType:c.AUTO,effectType:r.Friend,getEffetTargetsFunc:T.SelectSelf,castFunc:function(e){var a=e.caster,t=g.ins.curScene,c=[],l=new p,r=new Set,T=a.tileX,d=a.tileY;for(l.enqueue(u.getIdByXY(T,d));l.size>0;){var C=u.getXYById(l.dequeue());if(T=C[0],d=C[1],r.add(u.getIdByXY(T,d)),!t.mapManager.hasChar(T,d)&&(c.push([T,d]),6==c.length))break;for(var y=0,S=[[T,d-1],[T,d+1],[T-1,d],[T+1,d]];y<S.length;y++){var N=S[y],h=N[0],M=N[1];if(t.tileManager.isXYInMap(h,M)){var A=u.getIdByXY(h,M);r.has(A)||l.enqueue(A)}}}for(var v=0,m=c;v<m.length;v++){var F,k=m[v];(F=t.charManager).generateChar.apply(F,[1].concat(k,[i.ENEMY]))}t.charManager.charToTop(a),t.floatTextManager.makeBuffNameFloat("召唤",a),n().target(a.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:6,skillName:"区域伤害",effectRange:3,castRange:5,preCalRatio:.3,isATK:!0,isNomalATK:!1,desc:"对3格范围的敌人造成0.3倍伤害。",cd:3,apCost:60,selectOperateType:c.Manual,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:function(e){for(var t,c=e.caster,l=g.ins.curScene,r=a(e.targetChars);!(t=r()).done;){var i=t.value;i.hpChange(-C(.3,c,i))}l.charManager.charToTop(c),l.floatTextManager.makeBuffNameFloat(S[e.skillId].skillName,c),n().target(c.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:7,skillName:"区域斩杀",effectRange:3,castRange:5,preCalRatio:.3,isATK:!0,isNomalATK:!1,desc:"对3格范围的敌人造成10%最大生命的伤害，如果单位生命低于25%，则直接秒杀。",cd:0,apCost:60,selectOperateType:c.Manual,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:function(e){for(var t,c=e.caster,l=g.ins.curScene,r=a(e.targetChars);!(t=r()).done;){var i=t.value;i.hp/i.attr.maxHp<=.25?i.hpChangeTo(0):i.hpChange(.1*-i.attr.maxHp)}l.charManager.charToTop(c),l.floatTextManager.makeBuffNameFloat(S[e.skillId].skillName,c),n().target(c.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:8,skillName:"增强",effectRange:1,castRange:5,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"提升友方500%攻击力，下一次攻击有效。",cd:3,apCost:50,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Friend,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:function(e){for(var t,c=e.caster,l=g.ins.curScene,r=a(e.targetChars);!(t=r()).done;){var i=t.value,p=l.buffManager.newBuff(0,c);l.buffManager.attachBuff2Char(p,i)}l.charManager.charToTop(c),n().target(c.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:9,skillName:"龟甲术",effectRange:1,castRange:5,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"提升友方700防御，持续3回合。",cd:3,apCost:20,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Friend,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:function(e){for(var t,c=e.caster,l=g.ins.curScene,r=a(e.targetChars);!(t=r()).done;){var i=t.value,p=l.buffManager.newBuff(1,c);l.buffManager.attachBuff2Char(p,i)}l.charManager.charToTop(c),n().target(c.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:10,skillName:"协击辅助技能",effectRange:1,castRange:5,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"通过该技能将默认消息分解成能够供普攻使用的castinfo。",cd:0,apCost:0,selectOperateType:c.AUTO,canCastTileType:l.All,effectType:r.AllChar,getEffetTargetsFunc:T.JustReturnPreSelect,castFunc:function(e){var t=e.caster,n=g.ins.curScene,s=e.params.caster,c=e.params.target;if(s.camp==t.camp&&c.alive){for(var l,r=-1,i=a(t.skillIdAndCDs);!(l=i()).done;){var p=l.value;S[p[0]].isNomalATK&&(r=p[0])}r>=0&&S[r].castRange>=t.mapDisTo(c)&&n.evtQManager.oneEventInsertToWaitHead(new d({caster:t,skillId:r,params:{targetTileXY:[c.tileX,c.tileY]},notTriggerNext:!0},!1))}o.ins.sendMessage(f.SKILLFUNCEND)}},{skillId:11,skillName:"击杀后增加buff的辅助技能",effectRange:1,castRange:5,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"通过该技能给自己上一个100%攻击力的buff。",cd:0,apCost:0,selectOperateType:c.AUTO,canCastTileType:l.All,effectType:r.AllChar,getEffetTargetsFunc:T.JustReturnPreSelect,castFunc:function(e){var a=g.ins.curScene,t=a.buffManager.newBuff(4,e.caster);a.buffManager.attachBuff2Char(t,e.caster),o.ins.sendMessage(f.SKILLFUNCEND)}},{skillId:12,skillName:"龟甲术",effectRange:1,castRange:1,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"提升自身700点防御，持续3回合。",cd:3,apCost:50,selectOperateType:c.AUTO,effectType:r.Friend,getEffetTargetsFunc:T.SelectSelf,castFunc:function(e){var a=e.caster,t=g.ins.curScene,c=t.buffManager.newBuff(1,a);t.buffManager.attachBuff2Char(c,a),t.charManager.charToTop(a),n().target(a.node).to(.05,{scale:new s(1.2,1.2,1)}).to(.1,{scale:s.ONE}).call((function(){return o.ins.sendMessage(f.SKILLFUNCEND)})).start()}},{skillId:13,skillName:"怪物近战普攻",effectRange:1,castRange:1,preCalRatio:1,isATK:!0,isNomalATK:!0,desc:"对敌人造成1倍伤害。",cd:1,apCost:20,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:y},{skillId:14,skillName:"怪物远程普攻",effectRange:1,castRange:6,preCalRatio:1,isATK:!0,isNomalATK:!0,desc:"对敌人造成1倍伤害。",cd:1,apCost:20,selectOperateType:c.Manual,canCastTileType:l.All,effectType:r.Oppo,getEffetTargetsFunc:T.SelectByTileAndSelectType,castFunc:y},{skillId:15,skillName:"借机攻击辅助技能",effectRange:1,castRange:5,preCalRatio:1,isATK:!1,isNomalATK:!1,desc:"通过该技能将默认消息分解成能够供普攻使用的castinfo。",cd:0,apCost:0,selectOperateType:c.AUTO,canCastTileType:l.All,effectType:r.AllChar,getEffetTargetsFunc:T.JustReturnPreSelect,castFunc:function(e){var t=e.caster,n=g.ins.curScene,s=e.params.char;if(t.alive&&s.alive){for(var c,l=-1,r=a(t.skillIdAndCDs);!(c=r()).done;){var i=c.value;S[i[0]].isNomalATK&&(l=i[0])}l>=0&&n.evtQManager.oneEventInsertToWaitHead(new d({caster:t,skillId:l,params:{targetTileXY:[s.tileX,s.tileY]}},!1))}o.ins.sendMessage(f.SKILLFUNCEND)}}]);t._RF.pop()}}}));

System.register("chunks:///_virtual/SkillTargetSelectFuncs.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./SLGTileManager.ts","./SLGBattleSkill.ts","./StaticConfig.ts"],(function(e){var t,n,r,a,c,l;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy},function(e){r=e.SceneManager},function(e){a=e.SLGTileManager},function(e){c=e.SkillEffectType},function(e){l=e.GSC}],execute:function(){n._RF.push({},"ed021yG6spEgLj08WELq5p3","SkillTargetSelectFuncs",void 0);e("STSF",{SelectByTileAndSelectType:function(e,n,i){var u,s=l.SKSC[n];if(s.effectType==c.NoChar)return[];for(var o,f=r.ins.curScene,p=(u=f.mapManager).getRangeTileIds.apply(u,i.targetTileXY.concat([s.effectRange-1])),S=[],g=t(p);!(o=g()).done;){var T=o.value,h=a.getXYById(T),y=h[0],d=h[1],F=f.charManager.getCharFromXY(y,d);if(F)switch(s.effectType){case c.AllChar:S.push(F);break;case c.Friend:F.camp==e.camp&&S.push(F);break;case c.Oppo:F.camp!=e.camp&&S.push(F)}}return S},SelectSelf:function(e,t,n){return[e]},JustReturnPreSelect:function(e,t,n){return n.targetChars}});n._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleAttr.ts",["cc"],(function(t){var e;return{setters:[function(t){e=t.cclegacy}],execute:function(){e._RF.push({},"37589CChqxFgYcFzZIUIF/V","SLGBattleAttr",void 0);var r=t("AttrNames",function(t){return t.atk="atk",t.def="def",t.maxHp="maxHp",t.harmIncrease="harmIncrease",t.harmDecrease="harmDecrease",t.injureIncrease="injureIncrease",t.injureDecrease="injureDecrease",t.critRatio="critRatio",t.critPerc="critPerc",t.startAp="startAp",t}({}));t("SLGBattleAttr",function(){function t(){this.atk=void 0,this.def=void 0,this.maxHp=void 0,this.harmIncrease=void 0,this.harmDecrease=void 0,this.injureIncrease=void 0,this.injureDecrease=void 0,this.critPerc=void 0,this.critRatio=void 0,this.startAp=void 0}var e=t.prototype;return e.init=function(t){for(var e in r)this[e]=t[e]?t[e]:0},e.copyAttr=function(t){for(var e in r)e in t&&(this[e]=t[e])},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleChar.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChinaColor.ts","./SLGBattleAttr.ts","./Buff.ts","./SceneManager.ts","./MessageManager.ts","./DataType.ts","./StaticConfig.ts","./SLGBattleMapManager.ts"],(function(t){var e,a,i,s,n,r,o,h,p,c,l,u,d,f,g,_,C,S,m,A,v,H,M,N,B,b,y;return{setters:[function(t){e=t.inheritsLoose,a=t.createForOfIteratorHelperLoose,i=t.createClass},function(t){s=t.cclegacy,n=t._decorator,r=t.Sprite,o=t.Label,h=t.tween,p=t.Vec3,c=t.clamp,l=t.log,u=t.UIOpacity,d=t.Graphics,f=t.color,g=t.UITransform,_=t.Color,C=t.Animation,S=t.Component},function(t){m=t.ChinaColor},function(t){A=t.AttrNames,v=t.SLGBattleAttr},function(t){H=t.BuffType},function(t){M=t.SceneManager},function(t){N=t.MessageManager},function(t){B=t.MT},function(t){b=t.GSC},function(t){y=t.SLGBattleMapManager}],execute:function(){var I;s._RF.push({},"532e64wUotPIrwwk99kEtWJ","SLGBattleChar",void 0);var L=n.ccclass,k=(n.property,t("SLGBattleChar",L("SLGBattleChar")(I=function(t){function s(){for(var e,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))||this)._charSprite=void 0,e._HpSprite=void 0,e._HpMaskNode=void 0,e._HpLabel=void 0,e._ApLabel=void 0,e._ApBarSprite=void 0,e._OcuupationSprite=void 0,e.camp=void 0,e.tileX=void 0,e.tileY=void 0,e.charName="",e.charId=void 0,e.skillIdAndCDs=[],e.AIActionFunc=void 0,e._ap=void 0,e._hp=0,e.alive=!0,e._baseAttr=new v,e.attr=new v,e.buffs=new Set,e.status=new Set,e._attrAdd={},e._attrRatio={},e._isSelect=!1,e}e(s,t);var n=s.prototype;return n.init=function(t,e,i){void 0===i&&(i=null);var s=i||b.CHARSC[t];this._charSprite=this.node.getChildByName("CharSprite").getComponent(r),this._HpMaskNode=this.node.getChildByName("HpMask"),this._HpSprite=this._HpMaskNode.getChildByName("HpSprite").getComponent(r),this._HpLabel=this.node.getChildByName("HpLabel").getComponent(o),this._ApLabel=this.node.getChildByName("ApLabel").getComponent(o),this._ApBarSprite=this.node.getChildByName("ApBarSprite").getComponent(r),this._OcuupationSprite=this.node.getChildByName("OcuupationSprite").getComponent(r);var n=s.spriteName,h="occupation"+s.occupation,p=M.ins.curScene;this._charSprite.spriteFrame=p.resourceDict.get(n),this._OcuupationSprite.spriteFrame=p.resourceDict.get(h),this.camp=e,this.charId=t,this.toUnSelectState(),this.charName=s.charName,this.alive=!0;var c=s.passiveSkillIds;if(c)for(var l,u=a(c);!(l=u()).done;){var d=l.value,f=p.buffManager.newBuff(d,this);p.buffManager.attachBuff2Char(f,this)}this.skillIdAndCDs=s.skillIds.map((function(t){return[t,0|b.SKSC[t].startCd]})),this._baseAttr.init(s),this.attr.init(this._baseAttr),this._hp=this.attr.maxHp,this._ap=this.attr.startAp,this._HpLabel.string=""+this._hp,this._ApLabel.string="AP:"+this._ap,this.AIActionFunc=s.AIActionStrategy},n.apChange=function(t){t=Math.ceil(t);var e=Math.max(t+this._ap,0),a=e/Math.max(this.attr.startAp,e);return this._setApBarScale(a),this._ap=e,this._ApLabel.string="AP:"+e,this.isSelect&&N.ins.sendMessage(B.SELECTEDCHARAPCHANGE),e},n.apChangeTo=function(t){var e=t-this._ap;this.apChange(e)},n._setApBarScale=function(t){h().target(this._ApBarSprite.node).stop(),h().target(this._ApBarSprite.node).to(1,{scale:new p(t,1,1)}).start()},n.recoverAp=function(){this.apChangeTo(this.attr.startAp)},n.hpChange=function(t){if(this.alive){var e=(t=Math.ceil(t))+this._hp;return(e=c(e,0,this.attr.maxHp))!=this._hp&&this._damageFloat(e-this.hp),l(this.charName,"血量变化 "+this._hp+" -> "+e),this._hp=e,t<0&&(this.refreshHpMask(),h().target(this.node).to(.1,{angle:-15}).to(.2,{angle:15}).to(.1,{angle:0}).start()),0==this._hp&&this._dead(),this._HpLabel.string=""+this._hp,this._hp}},n.hpChangeTo=function(t){var e=t-this._hp;this.hpChange(e)},n._dead=function(){var t=this;l(this.charName,"死亡"),this.alive=!1;var e=M.ins.curScene;e.charManager.charRemoveFromStage(this),e.aiManager.AIActionData.delete(this),e.buffManager.removeAllBuff(this),this.unGlink(),N.ins.sendMessage(B.CHARDEAD,this),h().target(this.node.getComponent(u)).to(2,{opacity:0}).call((function(){t.node.removeFromParent()})).start()},n._damageFloat=function(t){M.ins.curScene.floatTextManager.makeDamageFloat(t,this)},n._changeHpColor=function(t){this._HpSprite.color=t},n.refreshHpMask=function(){var t=this._HpMaskNode.getComponent(d);t.clear(),t.fillColor=f(255,255,255,255);var e=this._HpMaskNode.getComponent(g).width;t.moveTo(e/2,e/2);var a=Math.max(2.75-this._hp/this.attr.maxHp*2,.751);t.arc(e/2,e/2,e,.75*Math.PI,a*Math.PI,!1),t.lineTo(e/2,e/2),t.fill()},n.refreshAttr=function(){for(var t in A)this._attrAdd[t]=0,this._attrRatio[t]=0;for(var e,i=a(this.buffs);!(e=i()).done;){var s=e.value;if(s.enable&&s.staticInfo.buffType==H.AttrChange)for(var n in A)s.staticInfo.attrNumAdd&&n in s.staticInfo.attrNumAdd&&(this._attrAdd[n]+=s.staticInfo.attrNumAdd[n]),s.staticInfo.attrPercAdd&&n in s.staticInfo.attrPercAdd&&(this._attrRatio[n]+=s.staticInfo.attrPercAdd[n])}for(var r in A){var o=this._baseAttr[r]*(1+this._attrRatio[r])+this._attrAdd[r];if(r==A.maxHp){var h=o-this.attr.maxHp;h+this._hp<=0&&(h=1-this._hp),this.hpChange(h)}this.attr[r]=o}},n.refreshBuffStatus=function(){this.status.clear();for(var t,e=a(this.buffs);!(t=e()).done;){var i=t.value;i.enable&&i.staticInfo.buffType==H.Status&&this.status.add(i.staticInfo.status)}this.refreshBuffIcon()},n.refreshBuffIcon=function(){},n.toSelectState=function(){this._isSelect=!0,this.camp==k.ENEMY?this._changeHpColor(_.RED):this._changeHpColor(_.GREEN)},n.toUnSelectState=function(){this._isSelect=!1,this.camp==k.ENEMY?this._changeHpColor(m.ZhuQing):this._changeHpColor(m.BaoShiLv),this.unGlink()},n.copyTargetChar=function(t){this._charSprite=this.node.getChildByName("CharSprite").getComponent(r),this._HpMaskNode=this.node.getChildByName("HpMask"),this._HpSprite=this._HpMaskNode.getChildByName("HpSprite").getComponent(r),this._HpLabel=this.node.getChildByName("HpLabel").getComponent(o),this._ApLabel=this.node.getChildByName("ApLabel").getComponent(o),this._ApBarSprite=this.node.getChildByName("ApBarSprite").getComponent(r),this._OcuupationSprite=this.node.getChildByName("OcuupationSprite").getComponent(r);var e=M.ins.curScene;this._charSprite.spriteFrame=e.resourceDict.get(b.CHARSC[t.charId].spriteName);var a="occupation"+b.CHARSC[t.charId].occupation;this._OcuupationSprite.spriteFrame=e.resourceDict.get(a),this.camp=t.camp,this.charId=t.charId,this.toUnSelectState(),this.charName=b.CHARSC[t.charId].charName,this.attr.copyAttr(t.attr),this._hp=t._hp,this._ap=t._ap,this._HpLabel.string=""+this._hp,this._ApLabel.string="AP:"+this._ap,this.toSelectState(),this.refreshHpMask()},n.glink=function(){this.node.getComponent(C).play()},n.unGlink=function(){this.node.getComponent(C).stop(),this.node.getComponent(u).opacity=255},n.moveAnimTo=function(t,e,a,i){h().target(this.node).to(i,{position:new p(t,e,0)}).call(a).start()},n.skillCdSubOne=function(){for(var t,e=a(this.skillIdAndCDs);!(t=e()).done;){var i=t.value;i[1]=Math.max(0,i[1]-1)}this.isSelect&&N.ins.sendMessage(B.SELECTEDCHARCDCHANGE)},n.mapDisTo=function(t){return y.MapDis(this.tileX,this.tileY,t.tileX,t.tileY)},n.getNormalAtkRange=function(){for(var t,e=-1,i=a(this.skillIdAndCDs);!(t=i()).done;){var s=t.value;b.SKSC[s[0]].isNomalATK&&(e=s[0])}return e>=0?b.SKSC[e].castRange:0},n.release=function(){this.buffs.clear(),h().target(this.node).stop()},i(s,[{key:"ap",get:function(){return this._ap}},{key:"hp",get:function(){return this._hp}},{key:"isSelect",get:function(){return this._isSelect}}]),s}(S))||I),t("SLGBTCAMP",function(t){return t[t.PLAYER=0]="PLAYER",t[t.ENEMY=1]="ENEMY",t}({})));s._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleCharManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SLGBattleChar.ts","./SceneManager.ts","./SLGTileManager.ts","./SLGBattleMapManager.ts","./SLGBattleEvtQueueManager.ts","./ISLGBattleMapState.ts","./ObjPool.ts","./MyUtil.ts"],(function(e){var t,r,i,a,n,o,c,h,s,l,d,S,u,v;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,r=e.createClass},function(e){i=e.cclegacy,a=e.find},function(e){n=e.SLGBattleChar,o=e.SLGBTCAMP},function(e){c=e.SceneManager},function(e){h=e.SLGTileManager},function(e){s=e.SLGBattleMapManager},function(e){l=e.SLGCharStepMoveEvent,d=e.SLGCharSkillCastEvent},function(e){S=e.SLGMAPSTATE},function(e){u=e.MyObjPool},function(e){v=e.MyUtil}],execute:function(){i._RF.push({},"e246f7NPCNLFI4SzZbFA516","SLGBattleCharManager",void 0);e("SLGBattleCharManager",function(){function e(){this._charsNode=void 0,this._chars=[],this._charPosDict=new Map,this._charSelected=void 0,this._preMoveIndicatorChar=void 0,this.movableFieldMapOfCharSelected=void 0,this._charPool=new u,this._preSkillCastInfo=void 0,this._preSkillTileSelected=[-1,-1],this.skillSelectedIdAndCd=void 0}var i=e.prototype;return i.init=function(){this._charsNode=a("TiledMapCanvas/Chars"),this._preMoveIndicatorChar=a("TiledMapCanvas/CharBase").getComponent(n),this._charPool.init(null,this._preMoveIndicatorChar.node)},i.generateChar=function(e,t,r,i,a){void 0===a&&(a=null);var o=c.ins.curScene,h=this._charPool.get().getComponent(n);h.init(e,i,a),this._charsNode.addChild(h.node);var s=o.tileManager.getPosByXY(t,r);h.node.setPosition(s.x,s.y),h.node.active=!0,this.charToTop(h),this._chars.push(h),this._charInfoSetToXY(h,t,r)},i.charToTop=function(e){this._charsNode.insertChild(e.node,this._chars.length)},i.getCharFromXY=function(e,t){return this._charPosDict.get(h.getIdByXY(e,t))},i.selectChar=function(e){null!=this._charSelected&&this._charSelected.toUnSelectState(),e.toSelectState(),this._charSelected=e},i.unSelectChar=function(){null!=this._charSelected&&(this._charSelected.toUnSelectState(),this._charSelected=null)},i.charSetTo=function(e,t,r){var i=c.ins.curScene.tileManager.getPosByXY(t,r);e.node.setPosition(i.x,i.y),this._charInfoSetToXY(e,t,r)},i.charSelectedMoveTo=function(e,t){this.charMoveTo(this.charSelected,e,t,this.movableFieldMapOfCharSelected)},i.charMoveTo=function(e,t,r,i){for(var a=c.ins.curScene,n=[],d=h.getIdByXY(t,r),u=s.unZipAPIDNum(i.get(d));99999!=u[1];)n.push(d),d=u[1],u=s.unZipAPIDNum(i.get(d));if(e.camp==o.PLAYER)a.mapManager.setMapState(S.MOVE);else{var v=e.node.getPosition(),M=a.tileManager.getPosByXY(t,r);a.tileManager.cameraLookAtMany([[v.x,v.y],[M.x,M.y]])}for(;n.length>0;)a.evtQManager.addEvent(new l(e,n.pop()));a.evtQManager.nextEvt()},i.charStepMoveTo=function(e,t,r,i,a){var n=c.ins.curScene;this._charInfoSetToXY(e,t,r);var o=n.tileManager.getPosByXY(t,r);this.charToTop(e),e.moveAnimTo(o.x,o.y,i,a)},i._charInfoSetToXY=function(e,t,r){var i=h.getIdByXY(e.tileX,e.tileY);e==this._charPosDict.get(i)&&this._charPosDict.delete(i),i=h.getIdByXY(t,r),null==this._charPosDict.get(i)&&this._charPosDict.set(i,e),e.tileX=t,e.tileY=r},i.hideChar=function(e){this._charPosDict.delete(h.getIdByXY(e.tileX,e.tileY)),e.node.active=!1},i.charRemoveFromStage=function(e){e.isSelect&&this.unSelectChar();var t=h.getIdByXY(e.tileX,e.tileY);this._charPosDict.delete(t)},i.recycleDeadChars=function(){for(var e,r=[],i=t(this.charsOnStage);!(e=i()).done;){var a=e.value;a.alive||r.push(a)}for(var n=0,o=r;n<o.length;n++){var c=o[n];v.removeObjFromArray(this.charsOnStage,c),c.release(),this._charPool.put(c.node)}},i.showPreMoveIndicatorChar=function(e,t){this._preMoveIndicatorChar.copyTargetChar(this.charSelected);var r=c.ins.curScene.tileManager.getPosByXY(e,t);this._preMoveIndicatorChar.node.setPosition(r.x,r.y),this._preMoveIndicatorChar.tileX=e,this._preMoveIndicatorChar.tileY=t,this._preMoveIndicatorChar.node.active=!0},i.hidePreMoveIndicatorChar=function(){this._preMoveIndicatorChar.node.active=!1},i.preMoveIndicatorCharMoveTo=function(e,t){var r=c.ins.curScene.tileManager.getPosByXY(e,t);this._preMoveIndicatorChar.node.setPosition(r.x,r.y)},i.getPreMoveRemainAP=function(){if(!this.isPreMoveDesSelect())return this.charSelected.ap;c.ins.curScene;var e=h.getIdByXY(this._preMoveIndicatorChar.tileX,this._preMoveIndicatorChar.tileY),t=this.movableFieldMapOfCharSelected.get(e),r=s.unZipAPIDNum(t),i=r[0];r[1];return i},i.castPreSkill=function(){var e=c.ins.curScene,t=new d(this._preSkillCastInfo);this._preSkillCastInfo=null,e.evtQManager.insertEvent(t),e.evtQManager.nextEvt()},i.setPreSkillTileSelected=function(e,t){this._preSkillTileSelected[0]=e,this._preSkillTileSelected[1]=t},i.isPreSkillPrepared=function(){return null!=this._preSkillCastInfo},i.preparePreSkillCastInfo=function(){this._preSkillCastInfo={caster:this.charSelected,skillId:this.skillSelectedIdAndCd[0],skillIdAndCd:this.skillSelectedIdAndCd,params:{targetTileXY:this._preSkillTileSelected}}},i.setSkillSelectedIdAndCd=function(e){this.skillSelectedIdAndCd=e},i.isPreMoveDesSelect=function(){return null!=this._preMoveIndicatorChar&&this._preMoveIndicatorChar.node.active},i.getPreMoveDesSelect=function(){return[this._preMoveIndicatorChar.tileX,this._preMoveIndicatorChar.tileY]},i.release=function(){this._charsNode.removeAllChildren();for(var e,r=t(this.charsOnStage);!(e=r()).done;){e.value.release()}this._preMoveIndicatorChar&&this._preMoveIndicatorChar.release(),this._charPool.release()},r(e,[{key:"charsOnStage",get:function(){return this._chars}},{key:"charSelected",get:function(){return this._charSelected}},{key:"preMoveIndicatorChar",get:function(){return this._preMoveIndicatorChar}}]),e}());i._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleCharMoveState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./ISLGBattleMapState.ts"],(function(e){var t,a,n,r,i,s,o,c;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,n=e.log},function(e){r=e.MessageManager},function(e){i=e.SceneManager},function(e){s=e.MT},function(e){o=e.SLGMAPSTATE,c=e.ISLGBattleMapState}],execute:function(){a._RF.push({},"9c7f7kpDsFHOobU0Eyp1mHA","SLGBattleCharMoveState",void 0);e("SLGBattleCharMoveState",function(e){function a(){return e.apply(this,arguments)||this}t(a,e);var c=a.prototype;return c.preSet=function(){i.ins.curScene.UIManager.hideEndPhaseButton(),r.ins.addListener(s.SLGEVTQUEND,this._waitMoveEnd,this)},c._waitMoveEnd=function(){n("收到时间链结束消息,CHARMOVE状态下肯定代表角色移动结束");var e=i.ins.curScene;if(e.charManager.isPreSkillPrepared())e.mapManager.setMapState(o.SKILLCAST),e.charManager.castPreSkill();else{if(null==e.charManager.charSelected)return void e.mapManager.setMapState(o.NORMAL);e.mapManager.setMapState(o.CHARSELECT),e.mapManager.refreshMoveInfoOfCharSelected()}},c.onTileTap=function(e,t){n("CM状态,角色移动中,不做任何反馈")},c.clear=function(){r.ins.removeListener(s.SLGEVTQUEND,this._waitMoveEnd,this),i.ins.curScene.UIManager.showEndPhaseButton()},a}(c));a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleCharSelectState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts","./SLGBattleChar.ts"],(function(e){var a,r,t,n,c,o,M;return{setters:[function(e){a=e.inheritsLoose,r=e.createClass},function(e){t=e.cclegacy},function(e){n=e.SceneManager},function(e){c=e.SLGMAPSTATE,o=e.ISLGBattleMapState},function(e){M=e.SLGBTCAMP}],execute:function(){t._RF.push({},"456aetGK5ZMHKIKrrtgq16U","SLGBattleCharSelectState",void 0);e("SLGBattleCharSelectState",function(e){function t(){for(var a,r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return(a=e.call.apply(e,[this].concat(t))||this)._preMoveXY=[-1,-1],a}a(t,e);var o=t.prototype;return o.preSet=function(){this._preMoveXY[0]=-1,this._preMoveXY[1]=-1;var e=n.ins.curScene;e.charManager.isPreMoveDesSelect()&&(this._preMoveXY=e.charManager.getPreMoveDesSelect()),e.charManager.charSelected.camp==M.PLAYER&&e.UIManager.showAndRefreshButtons(),e.UIManager.showShowInfoButtonGroupNode()},o.onTileTap=function(e,a){var r=n.ins.curScene;this._isPreMove&&(r.mapManager.clearMoveArraw(),r.charManager.charSelected.unGlink(),r.charManager.hidePreMoveIndicatorChar());var t=r.charManager.getCharFromXY(e,a);return null==t?r.charManager.charSelected.camp==M.ENEMY?(r.mapManager.clearMapTileIndicator(),r.charManager.unSelectChar(),void r.mapManager.setMapState(c.NORMAL)):r.mapManager.canMoveInMField(e,a,r.charManager.movableFieldMapOfCharSelected)?this._preMoveXY[0]==e&&this._preMoveXY[1]==a?(r.mapManager.clearMapTileIndicator(),void r.charManager.charSelectedMoveTo(e,a)):(r.charManager.showPreMoveIndicatorChar(e,a),r.charManager.charSelected.glink(),r.mapManager.paintMoveArrawTo(e,a),this._preMoveXY[0]=e,this._preMoveXY[1]=a,r.UIManager.refreshSkillButtonEnableState(),void r.charManager.preMoveIndicatorChar.apChangeTo(r.charManager.getPreMoveRemainAP())):(r.mapManager.clearMapTileIndicator(),r.charManager.unSelectChar(),void r.mapManager.setMapState(c.NORMAL)):t==r.charManager.charSelected?(this._preMoveXY[0]=-1,this._preMoveXY[1]=-1,void r.UIManager.refreshSkillButtonEnableState()):(r.charManager.selectChar(t),r.mapManager.refreshMoveInfoOfCharSelected(),void(r.charManager.charSelected.camp==M.PLAYER?r.UIManager.showAndRefreshButtons():r.UIManager.hideSkillButtons()))},o.clear=function(){n.ins.curScene.UIManager.hideSkillButtons(),n.ins.curScene.UIManager.hideShowInfoButtonGroupNode()},r(t,[{key:"_isPreMove",get:function(){return this._preMoveXY[0]>0}}]),t}(o));t._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleEvtQueueManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./SLGTileManager.ts","./SLGBattleSkill.ts","./Queue.ts","./Buff.ts"],(function(e){var t,n,i,u,s,a,r,o,c,h,v;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e.log},function(e){u=e.MessageManager},function(e){s=e.SceneManager},function(e){a=e.MT,r=e.DT},function(e){o=e.SLGTileManager},function(e){c=e.SkillUtil},function(e){h=e.Queue},function(e){v=e.TriggerTimeType}],execute:function(){n._RF.push({},"8e26ajyThRA4JnaySqL/ue6","SLGBattleEvtQueueManager",void 0);e("SLGBattleEvtQueueManager",function(){function e(){this._eventQueue=new h,this._waitEventQueue=new h,this._insertImmediateQueue=new h,this._insertQueue=new h}var t=e.prototype;return t.init=function(){u.ins.addListener(a.SKILLFUNCEND,this._onSkillFuncEnd,this)},t.release=function(){u.ins.removeListener(a.SKILLFUNCEND,this._onSkillFuncEnd,this)},t._onSkillFuncEnd=function(){i("收到技能释放结束消息，检索并进入下一个事件 nextEvt"),this.nextEvt()},t.addEvent=function(e){this._eventQueue.enqueue(e)},t.insertImmediateEvent=function(e){this._insertImmediateQueue.enqueue(e)},t.insertEvent=function(e){this._insertQueue.enqueue(e)},t.oneEventInsertToWaitHead=function(e){this._waitEventQueue.push(e),e.isTrigger&&(i("发送EvtAction开始前消息",e),u.ins.sendMessage(a.BFTT,{triggerTimeType:v.BeforeAction,content:e}))},t._oneEventFromQueueToWait=function(){this._insertImmediateQueue.size>0?this.oneEventInsertToWaitHead(this._insertImmediateQueue.dequeue()):this._insertQueue.size>0?this.oneEventInsertToWaitHead(this._insertQueue.dequeue()):this._eventQueue.size>0&&this.oneEventInsertToWaitHead(this._eventQueue.dequeue())},t.nextEvt=function(){s.ins.curScene.stageManager.isStageEnd?i("nextEvt， 游戏已结束，不继续执行"):this._waitEventQueue.size>0?this._waitEventQueue.dequeue().execute():(this._oneEventFromQueueToWait(),this._waitEventQueue.size>0?this._waitEventQueue.dequeue().execute():(i("发送事件链结束消息"),u.ins.sendMessage(a.SLGEVTQUEND)))},e}());var l=e("ISLGBattleEvt",(function(e,t){this.eventType=void 0,this.isTrigger=void 0,this.char=void 0,this.isTrigger=t,this.char=e}));e("SLGCharStepMoveEvent",function(e){function n(t,n,i){var u;return void 0===i&&(i=!0),(u=e.call(this,t,i)||this).eventType=r.MOVEEVT,u._desTileId=n,u}return t(n,e),n.prototype.execute=function(){var e=s.ins.curScene;if(this.char.alive){var t=o.getXYById(this._desTileId),n=t[0],i=t[1],u=e.mapManager.getTileApRequire(this.char.tileX,this.char.tileY,n,i,this.char.camp);this.char.apChange(-u),e.charManager.charStepMoveTo(this.char,n,i,(function(){return e.evtQManager.nextEvt()}),.15)}else e.evtQManager.nextEvt()},n}(l)),e("SLGCharSkillCastEvent",function(e){function n(t,n){var i;return void 0===n&&(n=!0),(i=e.call(this,t.caster,n)||this).eventType=r.SKILLEVT,i._skillCastInfo=t,i}return t(n,e),n.prototype.execute=function(){c.castSkill(this._skillCastInfo)},n}(l));n._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleMapManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./SLGTileManager.ts","./SLGMapIndicator.ts","./ObjPool.ts","./SLGBattleChar.ts","./Queue.ts","./ISLGBattleMapState.ts","./SLGBattleNormalState.ts","./SLGBattleTileSelectState.ts","./SLGBattleCharSelectState.ts","./SLGBattleCharMoveState.ts","./SLGBattleSkillCastState.ts","./SLGBattleSkillPreSelectState.ts","./MyUtil.ts","./ChinaColor.ts","./StaticConfig.ts","./MessageManager.ts","./DataType.ts"],(function(e){var t,a,n,i,r,o,s,l,d,c,h,p,g,u,S,f,v,M,I,_,m,T,C,A,y,E;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,a=e.createClass},function(e){n=e.cclegacy,i=e.find,r=e.log,o=e.Graphics,s=e.Color},function(e){l=e.SceneManager},function(e){d=e.SLGTileManager},function(e){c=e.TileIndcType,h=e.SLGMapIndicator},function(e){p=e.MyObjPool},function(e){g=e.SLGBTCAMP},function(e){u=e.Queue},function(e){S=e.SLGMAPSTATE},function(e){f=e.SLGBattleNormalState},function(e){v=e.SLGBattleTileSelectState},function(e){M=e.SLGBattleCharSelectState},function(e){I=e.SLGBattleCharMoveState},function(e){_=e.SLGBattleSkillCastState},function(e){m=e.SLGBattleSkillPreSelectState},function(e){T=e.MyUtil},function(e){C=e.ChinaColor},function(e){A=e.GSC},function(e){y=e.MessageManager},function(e){E=e.MT}],execute:function(){n._RF.push({},"29c2fMhkpBAoqf1X2bghB+3","SLGBattleMapManager",void 0);e("SLGBattleMapManager",function(){function e(){this._mapState=void 0,this._mapStates=void 0,this._mapInfoNode=void 0,this._mapInfoDangerFieldNode=void 0,this._mapInfoEdgeNode=void 0,this._MoveArrawNode=void 0,this._mapIndicatorNodePool=new p,this._MoveArrawIndictorPool=new p,this._movableFieldResult=new Map,this._nextStepSpreadField=new u,this._lineStartAndEndMap=new Map,this._dangerTileIdSet=new Set}var n=e.prototype;return n.init=function(e,t){this._mapStates=new Map,this._mapStates.set(S.NORMAL,new f),this._mapStates.set(S.TILESELECT,new v),this._mapStates.set(S.CHARSELECT,new M),this._mapStates.set(S.MOVE,new I),this._mapStates.set(S.SKILLCAST,new _),this._mapStates.set(S.SKILLPRESELECT,new m),this._mapState=this._mapStates.get(S.NORMAL),this._mapInfoNode=i("TiledMapCanvas/MapInfo"),this._mapInfoDangerFieldNode=i("TiledMapCanvas/MapInfoDangerField"),this._mapInfoEdgeNode=i("TiledMapCanvas/MapInfoEdge"),this._MoveArrawNode=i("TiledMapCanvas/CharMoveIndicator"),this._mapIndicatorNodePool.init(e),this._MoveArrawIndictorPool.init(t),y.ins.addListener(E.SLGEVTQUEND,this.refreshDangerTileAndEdgeAcdUI,this)},n.setMapState=function(e){r("退出",T.getClassName(this._mapState)),this._mapState.clear(),this._mapState=this._mapStates.get(e),r("进入 "+S[e]),this._mapState.preSet()},n.getMovableFieldMap=function(t){var a=l.ins.curScene;this._nextStepSpreadField.clear(),this._movableFieldResult.clear();var n=d.getIdByXY(t.tileX,t.tileY),i=e.zipAPIDNum(t.ap,99999);for(this._movableFieldResult.set(n,i),this._nextStepSpreadField.enqueue([n,t.ap]);this._nextStepSpreadField.size>0;)for(var r=this._nextStepSpreadField.dequeue(),o=r[0],s=r[1],c=d.getXYById(o),h=c[0],p=c[1],g=0,u=[[h,p+1],[h,p-1],[h+1,p],[h-1,p]];g<u.length;g++){var S=u[g];if(a.tileManager.isXYInMap(S[0],S[1])){var f=a.charManager.getCharFromXY(S[0],S[1]),v=this.getTileApRequire(h,p,S[0],S[1],t.camp);if((null==f||f.camp==t.camp)&&s>=v){var M=s-v,I=d.getIdByXY(S[0],S[1]),_=this._movableFieldResult.get(I);(null==_||M>e.unZipAPIDNum(_)[0])&&(this._movableFieldResult.set(d.getIdByXY(S[0],S[1]),e.zipAPIDNum(M,o)),this._nextStepSpreadField.enqueue([I,M]))}}}return this._movableFieldResult},n.getTileApRequire=function(e,t,a,n,i,r){void 0===r&&(r=!1);var o=l.ins.curScene,s=o.tileManager.getTileApRequire(a,n),d=s;if(r)return d;for(var c=0,h=[[e+1,t],[e-1,t],[e,t+1],[e,t-1]];c<h.length;c++){var p=h[c],g=o.charManager.getCharFromXY(p[0],p[1]);null!=g&&g.camp!=i&&(d=2*s)}return d},e.unZipAPIDNum=function(e){return[Math.floor(e/1e5),e%1e5]},e.zipAPIDNum=function(e,t){return 1e5*e+t},n.refreshMoveInfoOfCharSelected=function(){var e=l.ins.curScene,t=e.charManager.charSelected.camp==g.PLAYER?c.PlayerMove:c.EnemyMove,a=this.getMovableFieldMap(e.charManager.charSelected);e.charManager.movableFieldMapOfCharSelected=a,this.paintTileIndicator(a.keys(),t),this.paintTileIndicatorsEdge(a.keys())},n.clearMapTileIndicator=function(){for(var e,a=[],n=t(this._mapInfoNode.children);!(e=n()).done;){var i=e.value;a.push(i)}for(var r=0,o=a;r<o.length;r++){var s=o[r];this._mapIndicatorNodePool.put(s),s.removeFromParent()}this.clearIndicatorsEdge()},n.clearMapTileIndicatorOfType=function(e){for(var a,n=[],i=t(this._mapInfoNode.children.concat(this._mapInfoDangerFieldNode.children));!(a=i()).done;){var r=a.value;r.getComponent(h).indcType==e&&n.push(r)}for(var o=0,s=n;o<s.length;o++){var l=s[o];this._mapIndicatorNodePool.put(l),l.removeFromParent()}},n.paintTileIndicator=function(e,a,n,i){void 0===n&&(n=!1),void 0===i&&(i=!0);var r=l.ins.curScene;i&&this.clearMapTileIndicator();for(var o,s=t(e);!(o=s()).done;){var p,g=o.value;if(n||!this.hasCharById(g)){var u=this._mapIndicatorNodePool.get();u.getComponent(h).change2Type(a),a==c.DangerField?this._mapInfoDangerFieldNode.addChild(u):this._mapInfoNode.addChild(u);var S=(p=r.tileManager).getPosByXY.apply(p,d.getXYById(g));u.setPosition(S.x,S.y)}}},n.clearIndicatorsEdge=function(e){void 0===e&&(e=0),(0==e?this._mapInfoEdgeNode.getComponent(o):this._mapInfoDangerFieldNode.getComponent(o)).clear()},n.paintTileIndicatorsEdge=function(e,a){var n,i,r;void 0===a&&(a=0),this._getLinesStartAndEnd(e),0==a?(n=this._mapInfoEdgeNode.getComponent(o),i=C.JiZong,r=3):(n=this._mapInfoDangerFieldNode.getComponent(o),i=s.RED,r=1.5),n.clear(),n.strokeColor=i,n.lineWidth=r,n.lineCap=o.LineCap.ROUND;for(var l,d=t(this._lineStartAndEndMap.keys());!(l=d()).done;){var c=l.value,h=this._lineStartAndEndMap.get(c);h[4]&&(n.moveTo(h[0],h[1]),n.lineTo(h[2],h[3]))}n.stroke()},n._getLinesStartAndEnd=function(e){this._lineStartAndEndMap.clear();for(var a,n=t(e);!(a=n()).done;)for(var i=a.value,r=0,o=[0,1,2,3];r<o.length;r++){var s=o[r],l=this._getEdgeLineId(i,s);if(this._lineStartAndEndMap.has(l))this._lineStartAndEndMap.get(l)[4]=!1;else{var d=this._getEdgeLineStartAndEndLocXY(i,s);this._lineStartAndEndMap.set(l,[].concat(d,[!0]))}}return this._lineStartAndEndMap},n._getEdgeLineId=function(e,t){var a=d.getXYById(e);switch(t){case 0:return 1e3*a[0]+10*a[1]+1;case 1:return 1e3*(a[0]+1)+10*a[1]+1;case 2:return 1e3*a[0]+10*a[1];case 3:return 1e3*a[0]+10*(a[1]+1)}},n._getEdgeLineStartAndEndLocXY=function(e,t){var a,n=l.ins.curScene,i=d.getXYById(e),r=(a=n.tileManager).getPosByXY.apply(a,i),o=n.tileManager.tileSize;switch(t){case 0:return[r.x,r.y,r.x,r.y+o];case 1:return[r.x+o,r.y,r.x+o,r.y+o];case 2:return[r.x,r.y+o,r.x+o,r.y+o];case 3:return[r.x,r.y,r.x+o,r.y]}},n.paintDangerFieldIndicatorsWithEdge=function(){l.ins.curScene.UIManager.isShowDangerField()&&(r("重新绘制危险区域"),this._refreshDangerTileIds(),this.paintTileIndicator(this._dangerTileIdSet,c.DangerField,!0),this.paintTileIndicatorsEdge(this._dangerTileIdSet,1))},n._refreshDangerTileIds=function(){this._dangerTileIdSet.clear();for(var a,n=l.ins.curScene,i=t(n.charManager.charsOnStage);!(a=i()).done;){var r=a.value;if(r.camp!=g.PLAYER)for(var o,s=this.getMovableFieldMap(r),c=t(s.keys());!(o=c()).done;)for(var h,p=o.value,u=e.unZipAPIDNum(s.get(p)),S=u[0],f=(u[1],t(r.skillIdAndCDs));!(h=f()).done;){var v=h.value,M=v[1],I=A.SKSC[v[0]],_=I.apCost;if(0==M&&_<=S)for(var m,T=d.getXYById(p),C=T[0],y=T[1],E=this.getCastRangeResult(C,y,I.castRange),L=t(E);!(m=L()).done;)for(var B,N=m.value,F=d.getXYById(N),P=F[0],D=F[1],R=this.getEffectRangeResult(P,D,I.effectRange),w=t(R);!(B=w()).done;){var Y=B.value;this._dangerTileIdSet.add(Y)}}}},n.refreshDangerTileAndEdgeAcdUI=function(){l.ins.curScene.UIManager.isShowDangerField()&&(this.clearIndicatorsEdge(1),this.clearMapTileIndicatorOfType(c.DangerField),this.paintDangerFieldIndicatorsWithEdge())},n.hasChar=function(e,t){return null!=l.ins.curScene.charManager.getCharFromXY(e,t)},n.hasCharById=function(e){return this.hasChar.apply(this,d.getXYById(e))},n.canMoveInMField=function(e,t,a){return a.has(d.getIdByXY(e,t))&&!this.hasChar(e,t)},n.onTileTap=function(e,t){this._mapState.onTileTap(e,t)},n.clearMoveArraw=function(){for(var e,a=t(this._MoveArrawNode.children);!(e=a()).done;){var n=e.value;this._MoveArrawIndictorPool.put(n)}this._MoveArrawNode.removeAllChildren()},n.paintMoveArrawTo=function(t,a){this.clearMoveArraw();for(var n=l.ins.curScene,i=d.getIdByXY(t,a);99999!=i;){var r=i,o=i=e.unZipAPIDNum(n.charManager.movableFieldMapOfCharSelected.get(i))[1],s=d.getXYById(o),c=s[0],h=s[1],p=d.getXYById(r),g=p[0],u=p[1],S=n.tileManager.getPosByXY(c,h),f=this._MoveArrawIndictorPool.get();this._MoveArrawNode.addChild(f),f.setPosition(S.x,S.y),f.children[0].angle=g!=c?90*(g-c-1):90*(h-u)}},n.getCastRangeResult=function(e,t,a){return this.getRangeTileIds(e,t,a)},n.getEffectRangeResult=function(e,t,a){return this.getRangeTileIds(e,t,a-1)},n.getRangeTileIds=function(t,a,n){for(var i=[],r=l.ins.curScene,o=-n;o<=n;o++)for(var s=-n;s<=n;s++){var c=t+o,h=a+s;e.MapDis(t,a,c,h)<=n&&r.tileManager.isXYInMap(c,h)&&i.push(d.getIdByXY(c,h))}return i},e.MapDis=function(e,t,a,n){return Math.abs(e-a)+Math.abs(t-n)},n.release=function(){y.ins.removeListener(E.SLGEVTQUEND,this.refreshDangerTileAndEdgeAcdUI,this),this.clearMapTileIndicator(),this.clearMoveArraw(),this.mapState&&this.mapState.clear();for(var e,a=t(this._mapStates);!(e=a()).done;){e.value[1].release()}this._mapIndicatorNodePool.release(),this._MoveArrawIndictorPool.release()},a(e,[{key:"mapState",get:function(){return this._mapState}}]),e}());n._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleNormalState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts"],(function(e){var t,a,n,r,o,l;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,n=e.log},function(e){r=e.SceneManager},function(e){o=e.SLGMAPSTATE,l=e.ISLGBattleMapState}],execute:function(){a._RF.push({},"58b29lZ+tFP45MA1ghDRJiU","SLGBattleNormalState",void 0);e("SLGBattleNormalState",function(e){function a(){return e.apply(this,arguments)||this}return t(a,e),a.prototype.onTileTap=function(e,t){var a=r.ins.curScene,l=a.tileManager;n("Normal状态点击格子",e,t,l.getTiledPropByMapXY(e,t));var c=a.charManager.getCharFromXY(e,t);null!=c&&(a.charManager.selectChar(c),a.mapManager.refreshMoveInfoOfCharSelected(),a.mapManager.setMapState(o.CHARSELECT))},a}(l));a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattlePhaseManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./SDK.ts","./ISLGBattleMapState.ts","./MyUtil.ts","./MessageManager.ts","./DataType.ts","./SLGBattleChar.ts"],(function(e){var t,n,a,s,r,i,h,c,o,u,p;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,n=e.inheritsLoose},function(e){a=e.cclegacy,s=e.log},function(e){r=e.SceneManager},function(e){i=e.SDK},function(e){h=e.SLGMAPSTATE},function(e){c=e.MyUtil},function(e){o=e.MessageManager},function(e){u=e.MT},function(e){p=e.SLGBTCAMP}],execute:function(){a._RF.push({},"51410dqK35ApoJOsmfZgESy","SLGBattlePhaseManager",void 0);e("SLGBattlePhaseManager",function(){function e(){this._phase=void 0,this._phases=new Map}var n=e.prototype;return n.setPhase=function(e){s("退出phase",c.getClassName(this._phase)),this._phase.clear(),this._phase=this._phases.get(e),s("进入phase",S[e]),this._phase.preSet()},n.nextPhase=function(){this._phase.nextPhase()},n.init=function(){this._phases.set(S.PLAYERSTART,new M),this._phases.set(S.PLAYER,new f),this._phases.set(S.PLAYEREND,new P),this._phases.set(S.ENEMYSTART,new l),this._phases.set(S.ENEMY,new g),this._phases.set(S.ENEMYEND,new L),this._phase=this._phases.get(S.PLAYERSTART),this._phase.preSet()},n.release=function(){this._phase&&this._phase.clear();for(var e,n=t(this._phases);!(e=n()).done;){e.value[1].release()}},e}());var E=e("ISLGBattlePhase",function(){function e(){}var t=e.prototype;return t.release=function(){},t.clear=function(){},t.preSet=function(){},e}()),S=e("SLGBTPHASE",function(e){return e[e.PLAYERSTART=0]="PLAYERSTART",e[e.PLAYER=1]="PLAYER",e[e.PLAYEREND=2]="PLAYEREND",e[e.ENEMYSTART=3]="ENEMYSTART",e[e.ENEMY=4]="ENEMY",e[e.ENEMYEND=5]="ENEMYEND",e}({})),M=e("SLGPlayerStartPhase",function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var a=t.prototype;return a.preSet=function(){r.ins.curScene.buffManager.phaseDurationSub1(p.PLAYER),setTimeout(this.nextPhase,200)},a.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.PLAYER)},t}(E)),f=e("SLGPlayerPhase",function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var a=t.prototype;return a.preSet=function(){i.ins.showToast({title:"我方回合开始",duration:500});var e=r.ins.curScene;e.UIManager.showInteractUI(),e.UIManager.hideInteractBlockLayer()},a.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.PLAYEREND)},t}(E)),P=e("SLGPlayerEndPhase",function(e){function a(){return e.apply(this,arguments)||this}n(a,e);var s=a.prototype;return s.preSet=function(){for(var e,n=r.ins.curScene,a=t(n.charManager.charsOnStage);!(e=a()).done;){var s=e.value;s.camp==p.PLAYER&&(s.recoverAp(),s.skillCdSubOne())}n.mapManager.clearMapTileIndicator(),n.mapManager.clearMoveArraw(),n.charManager.hidePreMoveIndicatorChar(),n.charManager.unSelectChar(),n.mapManager.setMapState(h.NORMAL),n.UIManager.showInteractBlockLayer(),n.UIManager.hideInteractUI(),setTimeout(this.nextPhase,50)},s.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.ENEMYSTART)},a}(E)),l=e("SLGEnemyStartPhase",function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var a=t.prototype;return a.preSet=function(){i.ins.showToast({title:"敌方回合开始",duration:500});var e=r.ins.curScene;e.charManager.recycleDeadChars(),e.buffManager.phaseDurationSub1(p.ENEMY),setTimeout(this.nextPhase,1e3)},a.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.ENEMY)},t}(E)),g=e("SLGEnemyPhase",function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var a=t.prototype;return a.preSet=function(){o.ins.addListener(u.SLGEVTQUEND,this._onSLGEventQueueEnd,this),r.ins.curScene.aiManager.AIStart()},a._onSLGEventQueueEnd=function(){s("enemy phase收到事件链结束消息，意味着敌方AI的一个Action结束，发送角色ActionDone消息"),o.ins.sendMessage(u.CURENEMYACTIONDONE)},a.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.ENEMYEND)},a.clear=function(){o.ins.removeListener(u.SLGEVTQUEND,this._onSLGEventQueueEnd,this)},t}(E)),L=e("SLGEnemyEndPhase",function(e){function a(){return e.apply(this,arguments)||this}n(a,e);var s=a.prototype;return s.preSet=function(){for(var e,n=r.ins.curScene,a=t(n.charManager.charsOnStage);!(e=a()).done;){var s=e.value;s.camp==p.ENEMY&&(s.recoverAp(),s.skillCdSubOne())}n.mapManager.refreshDangerTileAndEdgeAcdUI(),setTimeout(this.nextPhase,50)},s.nextPhase=function(){r.ins.curScene.phaseManager.setPhase(S.PLAYERSTART)},a}(E));a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./IScene.ts","./AsyncLoad.ts","./SLGBattleUIManager.ts","./SLGTileManager.ts","./SLGBattleMapManager.ts","./SLGBattleCharManager.ts","./SLGBattleEvtQueueManager.ts","./SLGBattlePhaseManager.ts","./FloatTextManager.ts","./AIManager.ts","./GameData.ts","./DataType.ts","./StaticConfig.ts","./SLGStageManager.ts","./SLGBuffManager.ts","./SLGNormalGameMode.ts","./SLGRoughGameMode.ts"],(function(e){var a,t,n,r,i,s,o,u,c,g,M,l,h,f,d,p,m,_,v,S,G,L,B,F,I,y,A,T,P,b;return{setters:[function(e){a=e.inheritsLoose,t=e.createForOfIteratorHelperLoose,n=e.createClass,r=e.asyncToGenerator,i=e.regeneratorRuntime},function(e){s=e.cclegacy,o=e.log,u=e.TiledMapAsset,c=e.Prefab,g=e.SpriteFrame,M=e.Tween,l=e.find,h=e.assetManager},function(e){f=e.IScene},function(e){d=e.AsyncLoad},function(e){p=e.SLGBattleUIManager},function(e){m=e.SLGTileManager},function(e){_=e.SLGBattleMapManager},function(e){v=e.SLGBattleCharManager},function(e){S=e.SLGBattleEvtQueueManager},function(e){G=e.SLGBattlePhaseManager},function(e){L=e.FloatTextManager},function(e){B=e.AIManager},function(e){F=e.GameData},function(e){I=e.DT},function(e){y=e.GSC},function(e){A=e.SLGStageManager},function(e){T=e.BuffManager},function(e){P=e.SLGNormalGameMode},function(e){b=e.SLGRoughGameMode}],execute:function(){s._RF.push({},"56dd1soIsxBPo0h+FziPBQt","SLGBattleScene",void 0);e("SLGBattleScene",function(e){a(f,e);var s=f.prototype;function f(){var a;return(a=e.call(this,"SLGBattle")||this)._tileManager=void 0,a._mapManager=void 0,a._UIManager=void 0,a._charManager=void 0,a._evtQManager=void 0,a._phaseManager=void 0,a._FloatTextManager=void 0,a._aiManager=void 0,a._stageManager=void 0,a._buffManager=void 0,a.gameMode=void 0,a.resourceDict=new Map,a}return s.init=function(){this._tileManager=new m,this._tileManager.init(this.resourceDict.get("tiledMap02Asset")),this._UIManager=new p,this._UIManager.init(),this._mapManager=new _,this._mapManager.init(this.resourceDict.get("SLGMapIndicatorPrefab"),this.resourceDict.get("MoveArrawPrefab")),this._evtQManager=new S,this._evtQManager.init(),this._buffManager=new T,this._buffManager.init(),this._charManager=new v,this._charManager.init(),this._FloatTextManager=new L,this._FloatTextManager.init(),this._aiManager=new B,this._aiManager.init(),this.gameMode.init(),this._stageManager=new A,this._stageManager.init(),this._phaseManager=new G,this._phaseManager.init()},s.onMapTap=function(e,a){o("TAP",e,a),this._mapManager.onTileTap(e,a)},s.onMapLongTap=function(e,a){o("场景长按")},s.update=function(e){},s._prepareAsyncLoadTask=function(e,a){var n=this;e.push(d.loadFromBundle(a,"TileMap/tilemap02",u,(function(e){n.resourceDict.set("tiledMap02Asset",e)}))),e.push(d.loadFromBundle(a,"Prefabs/MapIndicator",c,(function(e){n.resourceDict.set("SLGMapIndicatorPrefab",e)}))),e.push(d.loadFromBundle(a,"Prefabs/MoveArrawIndictor",c,(function(e){n.resourceDict.set("MoveArrawPrefab",e)}))),e.push(d.loadFromBundle(a,"Pics/occupation/3rou/spriteFrame",g,(function(e){n.resourceDict.set("occupation3",e)}))),e.push(d.loadFromBundle(a,"Pics/occupation/1jinzhan/spriteFrame",g,(function(e){n.resourceDict.set("occupation1",e)}))),e.push(d.loadFromBundle(a,"Pics/occupation/2yuancheng/spriteFrame",g,(function(e){n.resourceDict.set("occupation2",e)})));var r=this.gameMode.stageRunningInfo,i=!r.charRunningInfos&&r.playerPreSetIdsAndXY?r.enemyIdsAndXY.concat(r.playerPreSetIdsAndXY):r.enemyIdsAndXY;if(r.charRunningInfos)for(var s,o=function(){var r=s.value,i=r.spriteName;e.push(d.loadFromBundle(a,"Pics/"+i+"/spriteFrame",g,(function(e){n.resourceDict.set(i,e)})));var o=r.dependResouces;if(o)for(var u,c=function(){var t=u.value;e.push(d.loadFromBundle(a,"Pics/"+t+"/spriteFrame",g,(function(e){n.resourceDict.set(t,e)})))},M=t(o);!(u=M()).done;)c()},M=t(r.charRunningInfos);!(s=M()).done;)o();for(var l,h=function(){var r=l.value[0],i=y.CHARSC[r].spriteName;e.push(d.loadFromBundle(a,"Pics/"+i+"/spriteFrame",g,(function(e){n.resourceDict.set(i,e)})));var s=y.CHARSC[r].dependResouces;if(s)for(var o,u=function(){var t=o.value;e.push(d.loadFromBundle(a,"Pics/"+t+"/spriteFrame",g,(function(e){n.resourceDict.set(t,e)})))},c=t(s);!(o=c()).done;)u()},f=t(i);!(l=f()).done;)h()},s.preload=function(){var e=r(i().mark((function e(){var a,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=F.ins[I.SLGBattleMode],e.next=e.t0===D.Normal?3:e.t0===D.Rough?5:7;break;case 3:return this.gameMode=new P,e.abrupt("break",8);case 5:return this.gameMode=new b,e.abrupt("break",8);case 7:return e.abrupt("break",8);case 8:return this.gameMode.prepareStageRunningInfo(),e.next=11,d.loadBundle("Arts");case 11:return a=e.sent,t=[],this._prepareAsyncLoadTask(t,a),e.next=16,Promise.all(t);case 16:return e.next=18,this.gameMode.preload();case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.release=function(){M.stopAll(),l("TiledMapCanvas").removeAllChildren(),l("UICanvas").removeAllChildren(),this._UIManager.release(),this._mapManager.release(),this._charManager.release(),this._tileManager.release(),this._evtQManager.release(),this._FloatTextManager.release(),this._aiManager.release(),this._stageManager.release(),this._buffManager.release(),this.gameMode.release();for(var e,a=t(this.resourceDict.keys());!(e=a()).done;){var n=e.value;h.releaseAsset(this.resourceDict.get(n))}},n(f,[{key:"tileManager",get:function(){return this._tileManager}},{key:"mapManager",get:function(){return this._mapManager}},{key:"UIManager",get:function(){return this._UIManager}},{key:"charManager",get:function(){return this._charManager}},{key:"evtQManager",get:function(){return this._evtQManager}},{key:"phaseManager",get:function(){return this._phaseManager}},{key:"floatTextManager",get:function(){return this._FloatTextManager}},{key:"aiManager",get:function(){return this._aiManager}},{key:"stageManager",get:function(){return this._stageManager}},{key:"buffManager",get:function(){return this._buffManager}}]),f}(f));var D=e("SLGGameMode",function(e){return e[e.Rough=0]="Rough",e[e.Normal=1]="Normal",e}({}));s._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleSkill.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./StaticConfig.ts","./Buff.ts","./SLGTileManager.ts","./SLGBattleChar.ts"],(function(e){var a,t,n,r,i,l,s,c,u,o,f;return{setters:[function(e){a=e.createForOfIteratorHelperLoose},function(e){t=e.cclegacy,n=e.log},function(e){r=e.MessageManager},function(e){i=e.SceneManager},function(e){l=e.MT},function(e){s=e.GSC},function(e){c=e.BuffDurationType,u=e.TriggerTimeType},function(e){o=e.SLGTileManager},function(e){f=e.SLGBTCAMP}],execute:function(){t._RF.push({},"b5774FwofdLQarOB6P0wQ3I","SLGBattleSkill",void 0);e("SkillSelectOperateType",function(e){return e[e.AUTO=0]="AUTO",e[e.Manual=1]="Manual",e}({}));var p=e("SkillCanCastTileType",function(e){return e[e.FriendUponTile=0]="FriendUponTile",e[e.OppoUponTile=1]="OppoUponTile",e[e.CharUponTile=2]="CharUponTile",e[e.TileWithoutChar=3]="TileWithoutChar",e[e.All=4]="All",e}({})),T=e("SkillEffectType",function(e){return e[e.AllChar=0]="AllChar",e[e.Friend=1]="Friend",e[e.Oppo=2]="Oppo",e[e.NoChar=3]="NoChar",e}({}));e("SkillUtil",function(){function e(){}return e.castSkill=function(t){n(t.caster.name,"释放",t.skillId);var o=i.ins.curScene,p=s.SKSC[t.skillId];if(e.canSkillCast(t)[0]){if(t.skillIdAndCd&&(t.skillIdAndCd[1]=p.cd,t.caster.isSelect&&r.ins.sendMessage(l.SELECTEDCHARCDCHANGE),t.caster.apChange(-p.apCost)),t.targetChars=p.getEffetTargetsFunc(t.caster,t.skillId,t.params),t.caster.camp==f.ENEMY){var T=t.caster.node.getPosition(),g=[];if(g.push([T.x,T.y]),t.targetChars)for(var C,d=a(t.targetChars);!(C=d()).done;){var S=C.value.node.getPosition();g.push([S.x,S.y])}o.tileManager.cameraLookAtMany(g)}if(p.castFunc(t),p.isATK){for(var h,M=a(t.caster.buffs);!(h=M()).done;){var v=h.value;v.staticInfo.durationType==c.ATK&&o.buffManager.buffDurSub1(v)}for(var k,y=a(t.targetChars);!(k=y()).done;){var A=k.value;if(!t.notTriggerNext){var F={triggerTimeType:u.AfterATK,content:{caster:t.caster,target:A}};r.ins.sendMessage(l.BFTT,F)}if(!A.alive){var m={triggerTimeType:u.AfterKill,content:{caster:t.caster,target:A}};r.ins.sendMessage(l.BFTT,m)}}}}else r.ins.sendMessage(l.SKILLFUNCEND)},e.isTargetEffect=function(e,a,t){switch(s.SKSC[e].effectType){case T.AllChar:return!0;case T.Friend:return a==t;case T.Oppo:return a!=t;case T.NoChar:return!1}},e.isTileSelectEnable=function(e,a,t){var n,r=(n=i.ins.curScene.charManager).getCharFromXY.apply(n,o.getXYById(e));switch(t.canCastTileType){case p.CharUponTile:return r?[!0,null]:[!1,"需要选择有角色的位置"];case p.FriendUponTile:return r&&r.camp==a.camp?[!0,null]:[!1,"需要选择有友方单位的位置"];case p.OppoUponTile:return r&&r.camp!=a.camp?[!0,null]:[!1,"需要选择有敌方单位的位置"];case p.TileWithoutChar:return null==r?[!0,null]:[!1,"需要选择没有角色的位置"]}return[!0,null]},e.canSkillCast=function(e){if(!e.caster.alive)return[!1,"释放者已死亡"];var a=s.SKSC[e.skillId];return a.canCastDudgeFunc?a.canCastDudgeFunc(e.caster,e.skillId):[!0,null]},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleSkillButton.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts","./StaticConfig.ts","./MessageManager.ts","./DataType.ts","./SDK.ts"],(function(t){var e,i,n,s,a,l,o,r,h,c,u,C,d,b;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,s=t.Label,a=t.Button,l=t.Node,o=t.Color,r=t.Component},function(t){h=t.SceneManager},function(t){c=t.SLGMAPSTATE},function(t){u=t.GSC},function(t){C=t.MessageManager},function(t){d=t.MT},function(t){b=t.SDK}],execute:function(){var S;i._RF.push({},"ceba0YkC5xDpK+TaQtALwlJ","SLGBattleSkillButton",void 0);var L=n.ccclass;n.property,t("SLGBattleSkillButton",L("SLGBattleSkillButton")(S=function(t){function i(){for(var e,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))||this)._apUseLabel=void 0,e._skillNameLabel=void 0,e._CDLabel=void 0,e._button=void 0,e._skillIdAndCd=void 0,e}e(i,t);var n=i.prototype;return n.init=function(t){this._skillIdAndCd=t;var e=u.SKSC[t[0]];this._apUseLabel=this.node.getChildByName("ApUseLabel").getComponent(s),this._CDLabel=this.node.getChildByName("CDLabel").getComponent(s),this._skillNameLabel=this.node.getChildByName("SkillNameLabel").getComponent(s),this._button=this.getComponent(a),this._setSkillNameLabel(e.skillName),this._setApUseLabel(e.apCost),this.node.active=!0,this.refreshButtonEnableState(),this.node.on(l.EventType.TOUCH_END,this._onClick,this),C.ins.addListener(d.SELECTEDCHARAPCHANGE,this.refreshButtonEnableState,this),C.ins.addListener(d.SELECTEDCHARCDCHANGE,this.refreshButtonEnableState,this)},n.refreshButtonEnableState=function(){this.buttonEnable();var t=this._skillIdAndCd[1];0==t?this._CDLabel.node.active=!1:(this._CDLabel.node.active=!0,this._CDLabel.color=o.RED,this.buttonDisable(),this._CDLabel.string="CD:"+t),this._isApSufficient()?this._apUseLabel.color=o.GREEN:(this._apUseLabel.color=o.RED,this.buttonDisable())},n._isApSufficient=function(){var t=h.ins.curScene,e=u.SKSC[this._skillIdAndCd[0]];return t.charManager.getPreMoveRemainAP()>=e.apCost},n._onClick=function(){if(0==this._skillIdAndCd[1])if(this._isApSufficient()){var t=h.ins.curScene;t.charManager.setSkillSelectedIdAndCd(this._skillIdAndCd),t.mapManager.setMapState(c.SKILLPRESELECT)}else b.ins.showToast({title:"AP不足",duration:1e3});else b.ins.showToast({title:"技能冷却中",duration:1e3})},n._setSkillNameLabel=function(t){this._skillNameLabel.string=t},n._setApUseLabel=function(t){this._apUseLabel.string="AP:"+Math.ceil(t)},n.buttonDisable=function(){this._button.interactable=!1},n.buttonEnable=function(){this._button.interactable=!0},n.release=function(){this.node.off(l.EventType.TOUCH_END,this._onClick,this),C.ins.removeListener(d.SELECTEDCHARAPCHANGE,this.refreshButtonEnableState,this),C.ins.removeListener(d.SELECTEDCHARCDCHANGE,this.refreshButtonEnableState,this)},i}(r))||S);i._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleSkillCastState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./ISLGBattleMapState.ts"],(function(e){var t,a,n,i,r,s,c,l;return{setters:[function(e){t=e.inheritsLoose},function(e){a=e.cclegacy,n=e.log},function(e){i=e.MessageManager},function(e){r=e.SceneManager},function(e){s=e.MT},function(e){c=e.SLGMAPSTATE,l=e.ISLGBattleMapState}],execute:function(){a._RF.push({},"d2ee21jzYhD6Z8/2IZCfdPI","SLGBattleSkillCastState",void 0);e("SLGBattleSkillCastState",function(e){function a(){return e.apply(this,arguments)||this}t(a,e);var l=a.prototype;return l.preSet=function(){var e=r.ins.curScene;e.UIManager.hideEndPhaseButton(),e.mapManager.clearMapTileIndicator(),i.ins.addListener(s.SLGEVTQUEND,this._waitSkillCastEnd,this)},l._waitSkillCastEnd=function(){n("收到时间链结束消息,SkillCast状态下肯定代表角色技能释放状态结束");var e=r.ins.curScene;e.charManager.charSelected&&e.charManager.charSelected.alive?(e.mapManager.setMapState(c.CHARSELECT),e.mapManager.refreshMoveInfoOfCharSelected()):e.mapManager.setMapState(c.NORMAL)},l.onTileTap=function(e,t){n("SkillCast状态,技能释放中,不做任何反馈")},l.clear=function(){var e=r.ins.curScene;i.ins.removeListener(s.SLGEVTQUEND,this._waitSkillCastEnd,this),e.UIManager.showEndPhaseButton()},a}(l));a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleSkillPreSelectState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts","./SLGMapIndicator.ts","./StaticConfig.ts","./SLGTileManager.ts","./MyUtil.ts","./SLGBattleSkill.ts","./SDK.ts","./SLGBattleChar.ts"],(function(e){var a,t,r,n,l,i,c,o,S,s,g,p,M,h;return{setters:[function(e){a=e.inheritsLoose,t=e.createForOfIteratorHelperLoose},function(e){r=e.cclegacy},function(e){n=e.SceneManager},function(e){l=e.SLGMAPSTATE,i=e.ISLGBattleMapState},function(e){c=e.TileIndcType},function(e){o=e.GSC},function(e){S=e.SLGTileManager},function(e){s=e.MyUtil},function(e){g=e.SkillSelectOperateType,p=e.SkillUtil},function(e){M=e.SDK},function(e){h=e.SLGBTCAMP}],execute:function(){r._RF.push({},"10c4dinf+9Hs4tTQN30kZaL","SLGBattleSkillPreSelectState",void 0);e("SLGBattleSkillPreSelectState",function(e){function r(){for(var a,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(a=e.call.apply(e,[this].concat(r))||this)._preSkillTapXY=[-1,-1],a._castRangeTileIds=void 0,a}a(r,e);var i=r.prototype;return i.preSet=function(){var e;this._preSkillTapXY[0]=-1,this._preSkillTapXY[1]=-1;var a=n.ins.curScene;a.UIManager.showSkillBackButton(),a.mapManager.clearMapTileIndicator();var t=a.charManager.charSelected,r=[t.tileX,t.tileY];a.charManager.isPreMoveDesSelect()&&(r=a.charManager.getPreMoveDesSelect());var l=a.charManager.skillSelectedIdAndCd[0],i=o.SKSC[l].castRange,S=(e=a.mapManager).getCastRangeResult.apply(e,r.concat([i]));this._castRangeTileIds=S,a.mapManager.paintTileIndicator(S,c.PlayerSkillCastRange,!1),a.mapManager.paintTileIndicatorsEdge(S),o.SKSC[l].selectOperateType==g.AUTO&&a.UIManager.showSkillConfirmButton()},i.onTileTap=function(e,a){if(this._preSkillTapXY[0]!=e||this._preSkillTapXY[1]!=a){var l=n.ins.curScene;if(s.contains(this._castRangeTileIds,S.getIdByXY(e,a))){var i=l.charManager.skillSelectedIdAndCd[0],g=p.isTileSelectEnable(S.getIdByXY(e,a),l.charManager.charSelected,o.SKSC[i]);if(!g[0])return void M.ins.showToast({title:g[1],duration:2e3});this._preSkillTapXY[0]=e,this._preSkillTapXY[1]=a,l.charManager.setPreSkillTileSelected(e,a);var u=o.SKSC[i].effectRange,f=l.mapManager.getEffectRangeResult(e,a,u);l.mapManager.clearMapTileIndicatorOfType(c.PlayerSkillEffectRange),l.mapManager.paintTileIndicator(f,c.PlayerSkillEffectRange,!1,!1),s.contains(f,S.getIdByXY.apply(S,l.charManager.getPreMoveDesSelect()))&&p.isTargetEffect(i,h.PLAYER,h.PLAYER)?l.charManager.preMoveIndicatorChar.glink():l.charManager.preMoveIndicatorChar.unGlink();for(var d,k=t(l.charManager.charsOnStage);!(d=k()).done;){var T=d.value,v=S.getIdByXY(T.tileX,T.tileY);s.contains(f,v)&&p.isTargetEffect(i,h.PLAYER,T.camp)?T.glink():T.isSelect||T.unGlink()}l.UIManager.showSkillConfirmButton()}}else r.skillCastConfirm()},i.clear=function(){var e=n.ins.curScene;e.UIManager.hideSkillConfirmButton(),e.UIManager.hideSkillBackButton(),e.charManager.preMoveIndicatorChar&&e.charManager.preMoveIndicatorChar.unGlink();for(var a,r=t(e.charManager.charsOnStage);!(a=r()).done;){var l=a.value;l.isSelect||l.unGlink()}},r.skillCastConfirm=function(){var e,a=n.ins.curScene;(a.charManager.preparePreSkillCastInfo(),a.charManager.isPreMoveDesSelect())?(a.mapManager.clearMapTileIndicator(),a.mapManager.clearMoveArraw(),a.charManager.hidePreMoveIndicatorChar(),a.charManager.charSelected.unGlink(),(e=a.charManager).charSelectedMoveTo.apply(e,a.charManager.getPreMoveDesSelect())):(a.mapManager.setMapState(l.SKILLCAST),a.charManager.castPreSkill())},r}(i));r._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleTileSelectState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts"],(function(e){var t,n,a,i,l;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,a=e.log},function(e){i=e.SceneManager},function(e){l=e.ISLGBattleMapState}],execute:function(){n._RF.push({},"091129DJBxFnLEnBVl2e4/s","SLGBattleTileSelectState",void 0);e("SLGBattleTileSelectState",function(e){function n(){return e.apply(this,arguments)||this}return t(n,e),n.prototype.onTileTap=function(e,t){var n=i.ins.curScene.tileManager;a("TS状态点击格子",n.getTiledPropByMapXY(e,t))},n}(l));n._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBattleUIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./ISLGBattleMapState.ts","./SLGBattleSkillPreSelectState.ts","./ObjPool.ts","./SLGBattleSkillButton.ts","./SLGMapIndicator.ts","./ChinaColor.ts","./SLGUIInfoGroup.ts"],(function(t){var o,e,n,i,a,s,l,h,r,u,d,c,B,_,f;return{setters:[function(t){o=t.createForOfIteratorHelperLoose},function(t){e=t.cclegacy,n=t.find,i=t.Node,a=t.Toggle,s=t.Label,l=t.Animation},function(t){h=t.SceneManager},function(t){r=t.SLGMAPSTATE},function(t){u=t.SLGBattleSkillPreSelectState},function(t){d=t.MyObjPool},function(t){c=t.SLGBattleSkillButton},function(t){B=t.TileIndcType},function(t){_=t.ChinaColor},function(t){f=t.SLGUIInfoGroup}],execute:function(){e._RF.push({},"b12e8QJuaBCqaIJuEGihVIW","SLGBattleUIManager",void 0);t("SLGBattleUIManager",function(){function t(){this._endPhaseButtonNode=void 0,this._interactionPanelNode=void 0,this._interactionBlockLayerNode=void 0,this._skillButtonFatherNode=void 0,this._skillButtonBaseNode=void 0,this._preSkillBackButtonNode=void 0,this._skillConfirmButtonNode=void 0,this._ShowDangerFieldGroupNode=void 0,this._isShowDangerFieldToggleNode=void 0,this._stageEndGroupNode=void 0,this._nextStageButtonNode=void 0,this._tryAgainButtonNode=void 0,this._StageEndLabelNode=void 0,this._InfoGroupNode=void 0,this._ShowInfoButtonNode=void 0,this._ShowInfoButtonGroupNode=void 0,this._AllInteractionBlockLayerNode=void 0,this._skillButtonNodePool=new d}var e=t.prototype;return e.init=function(){this._endPhaseButtonNode=n("UICanvas/InteractionPanel/EndPhaseButton"),this._interactionPanelNode=n("UICanvas/InteractionPanel"),this._interactionBlockLayerNode=n("UICanvas/InteractionBlockLayer"),this._skillButtonFatherNode=n("UICanvas/InteractionPanel/SkillButtons"),this._skillButtonBaseNode=n("UICanvas/InteractionPanel/SkillButtonBase"),this._preSkillBackButtonNode=n("UICanvas/InteractionPanel/PreSkillBackButton"),this._skillConfirmButtonNode=n("UICanvas/InteractionPanel/SkillConfirmButton"),this._ShowDangerFieldGroupNode=n("UICanvas/InteractionPanel/ShowDangerFieldGroup"),this._isShowDangerFieldToggleNode=n("UICanvas/InteractionPanel/ShowDangerFieldGroup/Toggle"),this._stageEndGroupNode=n("UICanvas/StageEndGroup"),this._nextStageButtonNode=this._stageEndGroupNode.getChildByName("NextStageButton"),this._tryAgainButtonNode=this._stageEndGroupNode.getChildByName("TryAgainButton"),this._StageEndLabelNode=this._stageEndGroupNode.getChildByName("StageEndLabel"),this._InfoGroupNode=n("UICanvas/InfoGroup"),this._ShowInfoButtonNode=n("UICanvas/InteractionPanel/ShowInfoButtonGroup/ShowInfoButton"),this._ShowInfoButtonGroupNode=n("UICanvas/InteractionPanel/ShowInfoButtonGroup"),this._AllInteractionBlockLayerNode=n("UICanvas/AllInteractionBlockLayer"),this._endPhaseButtonNode.on(i.EventType.TOUCH_END,this._onEndPhaseButtonTap,this),this._skillConfirmButtonNode.on(i.EventType.TOUCH_END,this._onSkillConfirmButtonTap,this),this._preSkillBackButtonNode.on(i.EventType.TOUCH_END,this._onSkillBackButtonTap,this),this._nextStageButtonNode.on(i.EventType.TOUCH_END,this._onNextStageButtonTap,this),this._tryAgainButtonNode.on(i.EventType.TOUCH_END,this._onTryAgainButtonTap,this),this._ShowInfoButtonNode.on(i.EventType.TOUCH_END,this._onShowInfoButtonTap,this),this._isShowDangerFieldToggleNode.on(a.EventType.TOGGLE,this._onShowDangerFieldToggleCheck,this),this._skillButtonNodePool.init(null,this._skillButtonBaseNode),this._InfoGroupNode.getComponent(f).init(),this.hideSkillButtons(),this.hideSkillConfirmButton(),this.hideSkillBackButton(),this.hideStageEndGroupNode(),this.hideAllInteractionBlockLayerNode()},e._onShowDangerFieldToggleCheck=function(){var t=this._isShowDangerFieldToggleNode.getComponent(a).isChecked,o=h.ins.curScene;t?o.mapManager.paintDangerFieldIndicatorsWithEdge():(o.mapManager.clearMapTileIndicatorOfType(B.DangerField),o.mapManager.clearIndicatorsEdge(1))},e.showAllInteractionBlockLayerNode=function(){this._AllInteractionBlockLayerNode.active=!0},e.hideAllInteractionBlockLayerNode=function(){this._AllInteractionBlockLayerNode.active=!1},e.showShowInfoButtonGroupNode=function(){this._ShowInfoButtonGroupNode.active=!0},e.hideShowInfoButtonGroupNode=function(){this._ShowInfoButtonGroupNode.active=!1},e.hideInfoGroupNode=function(){this._InfoGroupNode.active=!1},e.showInfoGroupNode=function(t){this._InfoGroupNode.active=!0,this._InfoGroupNode.getComponent(f).refreshInfo(t)},e.hideSkillBackButton=function(){this._preSkillBackButtonNode.active=!1},e.showSkillBackButton=function(){this._preSkillBackButtonNode.active=!0},e.hideSkillConfirmButton=function(){this._skillConfirmButtonNode.active=!1},e.showSkillConfirmButton=function(){this._skillConfirmButtonNode.active=!0},e.hideEndPhaseButton=function(){this._endPhaseButtonNode.active=!1},e.showEndPhaseButton=function(){this._endPhaseButtonNode.active=!0},e.hideSkillButtons=function(){this._skillButtonFatherNode.active=!1},e.showSkillButtons=function(){this._skillButtonFatherNode.active=!0},e.showAndRefreshButtons=function(){this.showSkillButtons(),this.refreshSkillButtons(h.ins.curScene.charManager.charSelected)},e.hideInteractUI=function(){this._interactionPanelNode.active=!1},e.showInteractUI=function(){this._interactionPanelNode.active=!0},e.hideInteractBlockLayer=function(){this._interactionBlockLayerNode.active=!1},e.showInteractBlockLayer=function(){this._interactionBlockLayerNode.active=!0},e.showStageEndGroupNode=function(){if(this._stageEndGroupNode.active=!0,h.ins.curScene.stageManager.isStageSuccess){var t=this._StageEndLabelNode.getComponent(s);t.string="战斗胜利",t.color=_.JiZong}this._StageEndLabelNode.getComponent(l).play()},e.showNextStageButton=function(){this._nextStageButtonNode.active=!0},e.hideNextStageButton=function(){this._nextStageButtonNode.active=!1},e.hideTryAgainButton=function(){this._tryAgainButtonNode.active=!1},e.showTryAgainButton=function(){this._tryAgainButtonNode.active=!0},e.hideStageEndGroupNode=function(){this._stageEndGroupNode.active=!1},e.showDangerFieldUIGroup=function(){this._ShowDangerFieldGroupNode.active=!0},e.hideDangerFieldUIGroup=function(){this._ShowDangerFieldGroupNode.active=!1},e._onEndPhaseButtonTap=function(){h.ins.curScene.phaseManager.nextPhase()},e.refreshSkillButtons=function(t){for(var e,n=o(this._skillButtonFatherNode.children);!(e=n()).done;){var i=e.value;i.getComponent(c).release(),this._skillButtonNodePool.put(i)}for(var a in this._skillButtonFatherNode.removeAllChildren(),t.skillIdAndCDs){var s=this._skillButtonNodePool.get().getComponent(c);s.init(t.skillIdAndCDs[a]),this._skillButtonFatherNode.addChild(s.node),s.node.setPosition(-120,70+120*parseInt(a))}},e.refreshSkillButtonEnableState=function(){for(var t,e=o(this._skillButtonFatherNode.children);!(t=e()).done;){t.value.getComponent(c).refreshButtonEnableState()}},e._onSkillBackButtonTap=function(){var t=h.ins.curScene;t.UIManager.hideSkillBackButton(),t.mapManager.refreshMoveInfoOfCharSelected(),t.mapManager.setMapState(r.CHARSELECT)},e._onSkillConfirmButtonTap=function(){u.skillCastConfirm()},e._onNextStageButtonTap=function(){h.ins.curScene.stageManager.nextStage()},e._onTryAgainButtonTap=function(){h.ins.curScene.stageManager.restartStage()},e._onShowInfoButtonTap=function(){var t=h.ins.curScene;this.showInfoGroupNode(t.charManager.charSelected)},e.isShowDangerField=function(){return this._isShowDangerFieldToggleNode.getComponent(a).isChecked},e.release=function(){this._endPhaseButtonNode.off(i.EventType.TOUCH_END,this._onEndPhaseButtonTap,this),this._skillConfirmButtonNode.off(i.EventType.TOUCH_END,this._onSkillConfirmButtonTap,this),this._preSkillBackButtonNode.off(i.EventType.TOUCH_END,this._onSkillBackButtonTap,this),this._isShowDangerFieldToggleNode.off(a.EventType.TOGGLE,this._onShowDangerFieldToggleCheck,this),this._nextStageButtonNode.off(i.EventType.TOUCH_END,this._onNextStageButtonTap,this),this._tryAgainButtonNode.off(i.EventType.TOUCH_END,this._onTryAgainButtonTap,this),this._ShowInfoButtonNode.off(i.EventType.TOUCH_END,this._onShowInfoButtonTap,this),this._InfoGroupNode.getComponent(f).release(),this._skillButtonNodePool.release()},t}());e._RF.pop()}}}));

System.register("chunks:///_virtual/SLGBuffManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./Buff.ts","./SLGBattleEvtQueueManager.ts"],(function(e){var t,f,r,n,a,i,u,o,s;return{setters:[function(e){t=e.createForOfIteratorHelperLoose},function(e){f=e.cclegacy},function(e){r=e.MessageManager},function(e){n=e.SceneManager},function(e){a=e.MT},function(e){i=e.Buff,u=e.BuffDurationType,o=e.BuffType},function(e){s=e.SLGCharSkillCastEvent}],execute:function(){f._RF.push({},"374c5yLDKJLTry0XdZ5tiFK","SLGBuffManager",void 0);e("BuffManager",function(){function e(){this.buffPool=[],this.buffs=new Set}var f=e.prototype;return f.init=function(){r.ins.addListener(a.BFTT,this._buffTrigger,this)},f.newBuff=function(e,t){var f=this.buffPool.length>0?this.buffPool.pop():new i;return f.initial(e,t),this.buffs.add(f),f},f.attachBuff2Char=function(e,t){e.attach2Char(t),t.refreshBuffIcon(),e.showBuffName()},f.changeBuffDuration=function(e,t){0!=e.duration&&(e.duration+=t,e.duration<=0&&this.removeBuffFromTarget(e))},f.buffDurSub1=function(e){this.changeBuffDuration(e,-1)},f.phaseDurationSub1=function(e){for(var f,r=t(this.buffs);!(f=r()).done;){var n=f.value;n.target&&n.target.alive&&n.target.camp==e&&n.staticInfo.durationType==u.Phase&&!n.staticInfo.isPassiveSkill&&this.buffDurSub1(n)}},f.removeBuffFromTarget=function(e){e.removeFromTarget(),this.buffs.delete(e),e.release(),this.buffPool.push(e)},f.removeAllBuff=function(e){for(var f,r=t(e.buffs);!(f=r()).done;){var n=f.value;this.removeBuffFromTarget(n)}},f._buffTrigger=function(e){for(var f,r=e.triggerTimeType,a=t(this.buffs);!(f=a()).done;){var i=f.value;if(i.enable&&i.staticInfo.buffType==o.Trigger&&i.staticInfo.skillTriggerTime==r&&i.staticInfo.skillTriggerDudgeFunc(i,e.content)){var u=n.ins.curScene,c=new s({caster:i.target,skillId:i.staticInfo.triggerSkillCfgId,params:e.content});u.evtQManager.oneEventInsertToWaitHead(c)}}},f.release=function(){r.ins.removeListener(a.BFTT,this._buffTrigger,this);for(var e,f=t(this.buffs);!(e=f()).done;){e.value.release()}for(var n,i=t(this.buffPool);!(n=i()).done;){n.value.release()}},e}());f._RF.pop()}}}));

System.register("chunks:///_virtual/SLGMapIndicator.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ChinaColor.ts"],(function(e){var o,r,a,n,t,l,c;return{setters:[function(e){o=e.inheritsLoose},function(e){r=e.cclegacy,a=e._decorator,n=e.Color,t=e.Sprite,l=e.Component},function(e){c=e.ChinaColor}],execute:function(){var i;r._RF.push({},"345f2zbrXFDo7mZVG9yl+m0","SLGMapIndicator",void 0);var s=a.ccclass,h=(a.property,c.getOtherAlphaOfColor(n.WHITE,128)),g=c.getOtherAlphaOfColor(n.RED,80),p=c.getOtherAlphaOfColor(n.BLACK,128),y=c.getOtherAlphaOfColor(c.JiZong,200),f=g,C=(e("SLGMapIndicator",s("SLGMapIndicator")(i=function(e){function r(){for(var o,r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return(o=e.call.apply(e,[this].concat(a))||this).indcType=void 0,o}o(r,e);var a=r.prototype;return a._changeColor=function(e){this.node.getComponent(t).color=e},a.change2Type=function(e){switch(this.indcType=e,e){case C.PlayerMove:this._changeColor(h);break;case C.EnemyMove:this._changeColor(g);break;case C.PlayerSkillCastRange:this._changeColor(p);break;case C.PlayerSkillEffectRange:this._changeColor(y);break;case C.DangerField:this._changeColor(f)}},r}(l))||i),e("TileIndcType",function(e){return e[e.EnemyMove=0]="EnemyMove",e[e.PlayerMove=1]="PlayerMove",e[e.PlayerSkillCastRange=2]="PlayerSkillCastRange",e[e.PlayerSkillEffectRange=3]="PlayerSkillEffectRange",e[e.DangerField=4]="DangerField",e}({})));r._RF.pop()}}}));

System.register("chunks:///_virtual/SLGNormalGameMode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./DataType.ts","./StaticConfig.ts","./ISLGGameMode.ts","./SceneManager.ts","./MainScene.ts"],(function(e){var n,t,a,i,o,r,s,u;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy},function(e){a=e.GameData},function(e){i=e.DT},function(e){o=e.GSC},function(e){r=e.ISLGGameMode},function(e){s=e.SceneManager},function(e){u=e.MainScene}],execute:function(){t._RF.push({},"557b7mzndlMaYaRlsk/vPqP","SLGNormalGameMode",void 0);e("SLGNormalGameMode",function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var r=t.prototype;return r.prepareStageRunningInfo=function(){var e=a.ins[i.CURSTAGEINFO],n=o.STAGESC[e];return this.stageRunningInfo=n,n},r.endStage=function(){var e=s.ins.curScene;if(e.UIManager.showStageEndGroupNode(),e.stageManager.isStageSuccess&&a.ins[i.CURSTAGEINFO]==o.STAGESC.length-1)return a.ins[i.CURSTAGEINFO]=0,e.UIManager.showAllInteractionBlockLayerNode(),void setTimeout((function(){s.ins.setNewScene(new u)}),400);e.stageManager.isStageSuccess||e.UIManager.hideNextStageButton(),e.UIManager.hideDangerFieldUIGroup(),e.UIManager.hideSkillButtons(),e.UIManager.hideEndPhaseButton()},r.init=function(){},r.release=function(){},t}(r));t._RF.pop()}}}));

System.register("chunks:///_virtual/SLGRoughGameMode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./DataType.ts","./StaticConfig.ts","./ISLGGameMode.ts","./SceneManager.ts","./SLGRoughGroup.ts","./MainScene.ts"],(function(n){var e,t,o,s,a,i,u,r,c,g,h,f,l,d;return{setters:[function(n){e=n.inheritsLoose,t=n.createForOfIteratorHelperLoose,o=n.asyncToGenerator,s=n.regeneratorRuntime},function(n){a=n.cclegacy,i=n.math,u=n.find},function(n){r=n.GameData},function(n){c=n.DT},function(n){g=n.GSC},function(n){h=n.ISLGGameMode},function(n){f=n.SceneManager},function(n){l=n.SLGRoughGroup},function(n){d=n.MainScene}],execute:function(){a._RF.push({},"eddc1vn3JlP+LBt+ic80jnD","SLGRoughGameMode",void 0);var p=[["增加1个远程单位",function(n){for(var e,o=3,s=t(r.ins[c.RoughCharRunningInfos]);!(e=s()).done;){3==e.value.charId&&(o=4)}var a=Object.assign({},g.CHARSC[o]);a.skillIds=[2],a.passiveSkillIds=[],r.ins[c.RoughCharRunningInfos].push(a)}],["增加1个近战单位",function(n){for(var e,o=8,s=t(r.ins[c.RoughCharRunningInfos]);!(e=s()).done;){e.value.charId==o&&(o=9)}var a=Object.assign({},g.CHARSC[o]);a.skillIds=[0],a.passiveSkillIds=[],r.ins[c.RoughCharRunningInfos].push(a)}],["攻击+100，血量-50",function(n){n.atk+=100,n.maxHp-=50,n.maxHp<=0&&(n.maxHp=1)}],["获得被动：队友发动攻击时，如果敌方在攻击范围内，同步发动一次攻击",function(n){n.passiveSkillIds.push(2)}],["获得被动：每次击杀敌方单位获得100%攻击力加成，持续3回合",function(n){n.passiveSkillIds.push(3)}],["获得主动：重击，对敌人造成3倍伤害，释放范围1格",function(n){n.skillIds.push(1)}],["获得主动：提升自身500%攻击力，下一次攻击有效。",function(n){n.skillIds.push(4)}],["获得主动：对3格范围的敌人造成0.3倍伤害，释放范围5格",function(n){n.skillIds.push(6)}],["获得主动：提升友方500%攻击力，下一次攻击有效。",function(n){n.skillIds.push(8)}],["获得主动：提升友方700防御，持续3回合。",function(n){n.skillIds.push(9)}]];n("SLGRoughGameMode",function(n){function t(){for(var e,t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return(e=n.call.apply(n,[this].concat(o))||this).roughRandEffects=[],e._slgRoughUIGroup=void 0,e}e(t,n);var a=t.prototype;return a.prepareStageRunningInfo=function(){var n=r.ins[c.CURSTAGEINFO],e=g.STAGESC[n],t={stageName:e.stageName,enemyIdsAndXY:e.enemyIdsAndXY,playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]],charRunningInfos:r.ins[c.RoughCharRunningInfos]};return this.stageRunningInfo=t,t},a.endStage=function(){var n=this,e=f.ins.curScene;if(this.roughRandEffects=[],e.UIManager.showStageEndGroupNode(),e.UIManager.hideNextStageButton(),e.stageManager.isStageSuccess){if(e.UIManager.hideTryAgainButton(),r.ins[c.CURSTAGEINFO]==g.STAGESC.length-1)return r.ins[c.CURSTAGEINFO]=0,e.UIManager.showAllInteractionBlockLayerNode(),void setTimeout((function(){f.ins.setNewScene(new d)}),400);for(var t in[0,1,2]){var o=4==r.ins[c.RoughCharRunningInfos].length?2:0,s=i.randomRangeInt(o,p.length);this.roughRandEffects.push(p[s])}setTimeout((function(){n._slgRoughUIGroup.show(n.roughRandEffects)}),500)}e.UIManager.hideDangerFieldUIGroup(),e.UIManager.hideSkillButtons(),e.UIManager.hideEndPhaseButton()},a.preload=function(){var n=o(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),a.init=function(){this._slgRoughUIGroup=u("UICanvas/RoughEndGroup").getComponent(l),this._slgRoughUIGroup.init()},a.release=function(){this._slgRoughUIGroup.release()},t}(h));a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGRoughGroup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RoughCharSelectSprite.ts","./GameData.ts","./SceneManager.ts","./DataType.ts","./SDK.ts","./SLGBattleScene.ts"],(function(e){var t,o,n,r,i,h,a,u,c,s,d,g,l,S;return{setters:[function(e){t=e.inheritsLoose,o=e.createForOfIteratorHelperLoose},function(e){n=e.cclegacy,r=e._decorator,i=e.Node,h=e.Label,a=e.Animation,u=e.Component},function(e){c=e.RoughCharSelectSprite},function(e){s=e.GameData},function(e){d=e.SceneManager},function(e){g=e.DT},function(e){l=e.SDK},function(e){S=e.SLGBattleScene}],execute:function(){var f;n._RF.push({},"ae301w/qqdD9pTgJKePgG18","SLGRoughGroup",void 0);var p=r.ccclass;r.property,e("SLGRoughGroup",p("SLGRoughGroup")(f=function(e){function n(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this)._roughCharSelectNode=void 0,t._roughAwardButtonsNode=void 0,t}t(n,e);var r=n.prototype;return r.init=function(){this._roughCharSelectNode=this.node.getChildByPath("CharSelectNodes"),this._roughAwardButtonsNode=this.node.getChildByPath("AwardButtons");for(var e,t=o(this._roughCharSelectNode.children);!(e=t()).done;){e.value.getComponent(c).init()}for(var n in this._roughCharSelectNode.children[0].getComponent(c).select(),this._roughAwardButtonsNode.children)this._roughAwardButtonsNode.children[n].on(i.EventType.TOUCH_END,this["getRoughAward0"+n+"ToSelect"],this)},r.show=function(e){for(var t in this.node.active=!0,this._roughAwardButtonsNode.children){this._roughAwardButtonsNode.children[t].getChildByName("Label").getComponent(h).string=e[t][0]}this.node.getComponent(a).play()},r.hide=function(){this.node.active=!1},r.getRoughSelectCharId=function(){for(var e,t=o(this._roughCharSelectNode.children);!(e=t()).done;){var n=e.value;if(n.getComponent(c).isSelect)return n.getComponent(c).charIndex}},r.getRoughAwardToSelect=function(e){var t=d.ins.curScene,o=t.gameMode,n=this.getRoughSelectCharId();o.roughRandEffects[e][1](s.ins[g.RoughCharRunningInfos][n]),t.UIManager.showAllInteractionBlockLayerNode(),l.ins.showToast({title:"奖励已获得",duration:300}),s.ins[g.CURSTAGEINFO]+=1,setTimeout((function(){d.ins.setNewScene(new S)}),1e3)},r.getRoughAward00ToSelect=function(){this.getRoughAwardToSelect(0)},r.getRoughAward01ToSelect=function(){this.getRoughAwardToSelect(1)},r.getRoughAward02ToSelect=function(){this.getRoughAwardToSelect(2)},r.release=function(){for(var e,t=o(this._roughCharSelectNode.children);!(e=t()).done;){e.value.getComponent(c).release()}for(var n in this._roughAwardButtonsNode.children)this._roughAwardButtonsNode.children[n].off(i.EventType.TOUCH_END,this["getRoughAward0"+n+"ToSelect"],this)},n}(u))||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/SLGStageManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameData.ts","./MessageManager.ts","./SceneManager.ts","./DataType.ts","./SLGBattleChar.ts","./SLGBattleScene.ts"],(function(e){var n,a,t,r,s,i,c,o,g,u;return{setters:[function(e){n=e.createForOfIteratorHelperLoose},function(e){a=e.cclegacy,t=e.log},function(e){r=e.GameData},function(e){s=e.MessageManager},function(e){i=e.SceneManager},function(e){c=e.MT,o=e.DT},function(e){g=e.SLGBTCAMP},function(e){u=e.SLGBattleScene}],execute:function(){a._RF.push({},"32f2fS1y/VHw4MNJ+PBQVLV","SLGStageManager",void 0);e("SLGStageManager",function(){function e(){this.isStageEnd=!1,this.isStageSuccess=!1}var a=e.prototype;return a.init=function(){for(var e,a=i.ins.curScene,t=a.gameMode.stageRunningInfo,r=n(t.enemyIdsAndXY);!(e=r()).done;){var o=e.value,u=o[0],S=o[1],f=o[2];a.charManager.generateChar(u,S,f,g.ENEMY)}if(t.charRunningInfos)for(var h in t.charRunningInfos){var d=t.charRunningInfos[h].charId,l=t.playerPreSetIdsAndXY[h],M=(l[0],l[1]),v=l[2];a.charManager.generateChar(d,M,v,g.PLAYER,t.charRunningInfos[h])}else if(t.playerPreSetIdsAndXY)for(var E,L=n(t.playerPreSetIdsAndXY);!(E=L()).done;){var I=E.value,p=I[0],A=I[1],R=I[2];a.charManager.generateChar(p,A,R,g.PLAYER)}s.ins.addListener(c.CHARDEAD,this._onCharDead,this)},a._onCharDead=function(){for(var e,a=0,r=0,s=i.ins.curScene,c=n(s.charManager.charsOnStage);!(e=c()).done;){var o=e.value;o.alive&&(o.camp==g.ENEMY?r++:a++)}0==r&&(this.isStageEnd=!0,this.isStageSuccess=!0),0==a&&(this.isStageEnd=!0,this.isStageSuccess=!1),this.isStageEnd&&this._stageEnd(),t("StageManager 收到角色死亡消息")},a._stageEnd=function(){i.ins.curScene.gameMode.endStage()},a.restartStage=function(){i.ins.curScene.UIManager.showAllInteractionBlockLayerNode(),setTimeout((function(){i.ins.setNewScene(new u)}),500)},a.nextStage=function(){r.ins[o.CURSTAGEINFO]++,this.restartStage()},a.release=function(){s.ins.removeListener(c.CHARDEAD,this._onCharDead,this)},e}());a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGTileManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SceneManager.ts","./StaticConfig.ts","./Queue.ts"],(function(e){var t,i,a,o,n,s,r,h,c,_,m,u,d,l,p;return{setters:[function(e){t=e.createForOfIteratorHelperLoose,i=e.regeneratorRuntime},function(e){a=e.cclegacy,o=e.find,n=e.TiledMap,s=e.Camera,r=e.UITransform,h=e.Node,c=e.log,_=e.Vec2,m=e.screen,u=e.clamp},function(e){d=e.SceneManager},function(e){l=e.GSC},function(e){p=e.Queue}],execute:function(){a._RF.push({},"48baazobGlITYbSkWnF6flz","SLGTileManager",void 0);e("SLGTileManager",function(){function e(){this._tiledMap=void 0,this._camera=void 0,this._mainLayer=void 0,this.tileSize=void 0,this._touchStartTime=void 0,this._isInLongTouch=void 0,this._maxCameraX=void 0,this._maxCameraY=void 0,this._minCameraX=void 0,this._minCameraY=void 0}var a=e.prototype;return a.init=function(e){this._tiledMap=o("TiledMapCanvas/TiledMap").getComponent(n),this._camera=o("TiledMapCanvas/TiledMapCamera").getComponent(s),this._tiledMap.tmxAsset=e,this._tiledMap.enableCulling=!1,this._mainLayer=this._tiledMap.getLayer("Main"),this.tileSize=this._tiledMap.getTileSize().x;var t=this._tiledMap.node.getComponent(r).contentSize;this._camera.node.setPosition(t.x/2,t.y/2),this._camera.orthoHeight=150,this._resetCameraPosLimit(),this._tiledMap.node.on(h.EventType.TOUCH_MOVE,this._touchMove,this),this._tiledMap.node.on(h.EventType.TOUCH_START,this._onTouchStart,this),this._tiledMap.node.on(h.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this._tiledMap.node.on(h.EventType.TOUCH_END,this._onTouchEnd,this)},a._onTouchStart=function(e){e.getAllTouches().length>1||(this._touchStartTime=Date.now(),this._isInLongTouch=!0)},a._onTouchCancel=function(e){c("取消Touch")},a._onTouchEnd=function(e){if(this._isInLongTouch){var t=this.getMapXYByMapLoc(this.getMapLocFromScreenLoc(e.getLocation()));Date.now()-this._touchStartTime>300?this._sendLongTapMsgToScene.apply(this,t):this._sendTapMsgToScene.apply(this,t)}else c("长按期间手指曾发生移动")},a._touchMove=function(e){var i=e.getAllTouches();if(1==i.length){var a=e.getPreviousLocation(),o=e.getLocation();this._cameraMoveTo(this._camera.node.position.x+.3*(a.x-o.x),this._camera.node.position.y+.3*(a.y-o.y))}else if(2==i.length){var n=i[0],s=i[1],r=_.distance(n.getPreviousLocation(),s.getPreviousLocation()),h=_.distance(n.getLocation(),s.getLocation());this._cameraZoom(r/(h+.01))}for(var c,m=t(e.getAllTouches());!(c=m()).done;){var u=c.value;_.distance(u.getStartLocation(),u.getLocation())>.4&&(this._isInLongTouch=!1)}},a._sendTapMsgToScene=function(e,t){d.ins.curScene.onMapTap(e,t)},a._sendLongTapMsgToScene=function(e,t){d.ins.curScene.onMapLongTap(e,t)},a.getMapLocFromScreenLoc=function(e){var t=m.windowSize,i=this._camera.node.getPosition();return e.subtract2f(t.x/2,t.y/2).multiplyScalar(2*this._camera.orthoHeight/t.y).add2f(i.x,i.y)},a.getMapXYByMapLoc=function(e){return[Math.floor(e.x/this._tiledMap.getTileSize().x),this._tiledMap.getMapSize().y-Math.floor(e.y/this._tiledMap._mapSize.y)-1]},a.getTiledPropByMapXY=function(e,t){return this._tiledMap.getPropertiesForGID(this._mainLayer.getTileGIDAt(e,t))},a.getPosByXY=function(e,t){return this._mainLayer.getPositionAt(e,t)},e.getIdByXY=function(e,t){return e+100*t},e.getXYById=function(e){return[e%100,Math.floor(e/100)]},a.isXYInMap=function(e,t){return!(e<0||t<0||e>=this._tiledMap._tileSize.x||t>=this._tiledMap._tileSize.y)},a.getTileApRequire=function(e,t){return l.TILEAPR[this._tiledMap.getPropertiesForGID(this._mainLayer.getTileGIDAt(e,t)).type]},a.besideTileGenerator=i().mark((function t(a,o){var n,s,r,h,c,_,m,u,d;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new p,s=new Set,n.enqueue(e.getIdByXY(a,o));case 3:if(!(n.size>0)){t.next=13;break}return r=e.getXYById(n.dequeue()),a=r[0],o=r[1],s.add(e.getIdByXY(a,o)),t.next=10,[a,o];case 10:for(h=0,c=[[a,o-1],[a,o+1],[a-1,o],[a+1,o]];h<c.length;h++)m=(_=c[h])[0],u=_[1],this.isXYInMap(a,o)&&(d=e.getIdByXY(m,u),s.has(d)||n.enqueue(d));t.next=3;break;case 13:case"end":return t.stop()}}),t,this)})),a._resetCameraPosLimit=function(){var e=this._tiledMap.node.getComponent(r).contentSize,t=this._camera.orthoHeight,i=m.windowSize;this._maxCameraY=e.y/2+(e.y/2-t),this._minCameraY=e.y/2-(e.y/2-t),this._maxCameraX=e.x/2+(e.x/2-t*i.x/i.y),this._minCameraX=e.x/2-(e.x/2-t*i.x/i.y);var a=this._camera.node.getPosition();this._cameraMoveTo(a.x,a.y)},a._cameraMoveTo=function(e,t){this._camera.node.setPosition(u(e,this._minCameraX,this._maxCameraX),u(t,this._minCameraY,this._maxCameraY))},a._cameraZoom=function(e){var t=this._camera.orthoHeight*e;this._camera.orthoHeight=u(t,150,300),this._resetCameraPosLimit()},a.cameraLookAt=function(e,t){this._camera.node.setPosition(u(e,this._minCameraX,this._maxCameraX),u(t,this._minCameraY,this._maxCameraY))},a.cameraLookAtMany=function(e){for(var i,a=1e4,o=-1e4,n=-1e4,s=1e4,r=t(e);!(i=r()).done;){var h=i.value,c=h[0],_=h[1];c<a&&(a=c),c>o&&(o=c),_>n&&(n=_),_<s&&(s=_)}this._camera.node.setPosition(u((a+o)/2,this._minCameraX,this._maxCameraX),u((n+s)/2,this._minCameraY,this._maxCameraY));var d=(n-s+100)/2,l=m.windowSize,p=(o-a+50)/2*l.y/l.x,g=Math.max(p,d);this._camera.orthoHeight=u(g,150,300)},a.release=function(){this._tiledMap.node.off(h.EventType.TOUCH_MOVE,this._touchMove,this),this._tiledMap.node.off(h.EventType.TOUCH_START,this._onTouchStart,this),this._tiledMap.node.off(h.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this._tiledMap.node.off(h.EventType.TOUCH_END,this._onTouchEnd,this)},e}());a._RF.pop()}}}));

System.register("chunks:///_virtual/SLGUIInfoGroup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SLGBattleChar.ts","./SceneManager.ts","./StaticConfig.ts","./Buff.ts"],(function(o){var e,t,i,n,s,r,c,a,h,l,d,f,p,u,b;return{setters:[function(o){e=o.inheritsLoose,t=o.createForOfIteratorHelperLoose},function(o){i=o.cclegacy,n=o._decorator,s=o.Node,r=o.UITransform,c=o.RichText,a=o.Sprite,h=o.Color,l=o.Label,d=o.Component},function(o){f=o.SLGBTCAMP},function(o){p=o.SceneManager},function(o){u=o.GSC},function(o){b=o.BuffDurationType}],execute:function(){var C;i._RF.push({},"f9ff17xu4NEy4aoDfU2crt6","SLGUIInfoGroup",void 0);var N=n.ccclass;n.property,o("SLGUIInfoGroup",N("SLGUIInfoGroup")(C=function(o){function i(){for(var e,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(e=o.call.apply(o,[this].concat(i))||this)._CharSpriteBGNode=void 0,e._CharSpriteNode=void 0,e._CharNameLabelNode=void 0,e._attrsRichTextNode=void 0,e._skillsRichTextNode=void 0,e._passiveskillsRichTextNode=void 0,e._buffsRichTextNode=void 0,e._hideInfoButtonNode=void 0,e._OccupationSpriteNode=void 0,e}e(i,o);var n=i.prototype;return n.init=function(){this._CharSpriteBGNode=this.node.getChildByPath("CharSpriteBG"),this._CharSpriteNode=this.node.getChildByPath("CharSpriteBG/CharSprite"),this._CharNameLabelNode=this.node.getChildByPath("CharNameLabel"),this._OccupationSpriteNode=this.node.getChildByPath("OccupationSprite"),this._attrsRichTextNode=this.node.getChildByPath("ScrollView/view/content/attrs"),this._skillsRichTextNode=this.node.getChildByPath("ScrollView/view/content/skills"),this._passiveskillsRichTextNode=this.node.getChildByPath("ScrollView/view/content/passiveskills"),this._buffsRichTextNode=this.node.getChildByPath("ScrollView/view/content/buffs"),this._hideInfoButtonNode=this.node.getChildByPath("HideInfoButton/HideInfoButton"),this._hideInfoButtonNode.on(s.EventType.TOUCH_END,this._onHideInfoButtonTap,this);for(var o=this.node.getComponent(r).width,e=0,t=[this._attrsRichTextNode,this._skillsRichTextNode,this._passiveskillsRichTextNode,this._buffsRichTextNode];e<t.length;e++){t[e].getComponent(c).maxWidth=o-100}},n.refreshInfo=function(o){var e=p.ins.curScene;this._CharSpriteBGNode.getComponent(a).color=o.camp==f.ENEMY?h.RED:h.GREEN,this._CharNameLabelNode.getComponent(l).string=o.charName;var i=u.CHARSC[o.charId].spriteName;this._CharSpriteNode.getComponent(a).spriteFrame=e.resourceDict.get(i),this._OccupationSpriteNode.getComponent(a).spriteFrame=e.resourceDict.get("occupation"+u.CHARSC[o.charId].occupation);var n="<size=35><b><color=#0>属性</color></b></size>\n\n<size=25><color=#0>生命:  <b><color=#DE7622>"+o.hp+"</color></b>\n行动:<color=#DE7622><b>  "+o.ap+"</b></color>\n攻击:<color=#DE7622><b>  "+o.attr.atk+"</b></color>\n防御:<color=#DE7622><b>  "+o.attr.def+"</b></color>\n</color></size>";this._attrsRichTextNode.getComponent(c).string=n;for(var s,r="",d=[],C=t(o.skillIdAndCDs);!(s=C()).done;){var N=s.value,v=N[0],g=N[1],_=u.SKSC[v];d.push("<size=25><b><color=#DE7622>"+_.skillName+"</color></b>  \n<b>冷却时间</b>:  <color=#DE7622>"+g+" / "+_.cd+"</color>  回合    \n<b>行动消耗</b>:  <color=#DE7622>"+_.apCost+"</color>  行动点\n<b>释放范围</b>:  <color=#DE7622>"+(0==_.castRange?"全屏":_.castRange)+"</color>  格\n<b>作用范围</b>:  <color=#DE7622>"+(0==_.effectRange?"全屏":_.effectRange)+"</color>  格\n"+_.desc+"</size>\n")}d.length>0&&(r="<color=#0><size=35><b>主动技能</b></size>\n\n"+d.join("\n")+"</color>"),this._skillsRichTextNode.getComponent(c).string=r;for(var S,I="",B=[],T=t(o.buffs);!(S=T()).done;){var m=S.value;m.staticInfo.isPassiveSkill&&B.push("<size=25><b><color=#DE7622>"+m.staticInfo.name+"</color></b>\n"+m.staticInfo.description+"</size>")}B.length>0&&(I="<color=#0><size=35><b>被动技能</b></size>\n\n"+B.join("\n")+"</color>"),this._passiveskillsRichTextNode.getComponent(c).string=I;for(var R,E="",D=[],x=t(o.buffs);!(R=x()).done;){var y=R.value;y.showBuffName&&!y.staticInfo.isPassiveSkill&&D.push("<size=25><b><color=#DE7622>"+y.staticInfo.name+"</color></b>\n持续至下 <color=#DE7622><b>"+y.duration+"</b></color> "+(y.staticInfo.durationType==b.Phase?"回合开始前":"次攻击")+"\n"+y.staticInfo.description+"\n</size>")}D.length>0&&(E="<color=#0><size=35><b>状态</b></size>\n\n"+D.join("\n")+"</color>"),this._buffsRichTextNode.getComponent(c).string=E+"\n<color=#DE7622><size=30><b>——— ฅ՞• •՞ฅ ———</b></size></color>"},n._onHideInfoButtonTap=function(){this.node.active=!1},n.release=function(){this._hideInfoButtonNode.off(s.EventType.TOUCH_END,this._onHideInfoButtonTap,this)},i}(d))||C);i._RF.pop()}}}));

System.register("chunks:///_virtual/StageConfig.ts",["cc"],(function(e){var d;return{setters:[function(e){d=e.cclegacy}],execute:function(){d._RF.push({},"36b95mVKY5GKocfVBbF5BnN","StageConfig",void 0);e("StageConfig",[{id:0,stageName:"关卡0",enemyIdsAndXY:[[1,5,14]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19]]},{id:1,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:2,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:3,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:4,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:5,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:6,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[1,11,16],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:7,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[1,11,16],[1,12,16],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:8,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[1,11,16],[1,12,16],[7,11,15],[7,12,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:9,stageName:"关卡1",enemyIdsAndXY:[[1,6,16],[1,5,16],[1,11,16],[1,12,16],[7,11,15],[7,12,15],[7,5,15],[7,6,15]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]},{id:10,stageName:"关卡2",enemyIdsAndXY:[[1,6,16],[1,5,16],[1,11,16],[1,12,16],[7,11,15],[7,12,15],[7,5,15],[7,6,15],[2,11,17]],playerPreSetIdsAndXY:[[3,6,19],[4,7,19],[5,8,19],[6,9,19]]}]);d._RF.pop()}}}));

System.register("chunks:///_virtual/StartScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./IScene.ts","./SceneManager.ts","./MainScene.ts","./GameData.ts","./DataType.ts"],(function(n){var e,t,r,c,a,o,i,u,s,f;return{setters:[function(n){e=n.inheritsLoose,t=n.asyncToGenerator,r=n.regeneratorRuntime},function(n){c=n.cclegacy,a=n._decorator},function(n){o=n.IScene},function(n){i=n.SceneManager},function(n){u=n.MainScene},function(n){s=n.GameData},function(n){f=n.DT}],execute:function(){var p;c._RF.push({},"a6dfb4giDtEv7pBoIUC+d0j","StartScene",void 0);var S=a.ccclass;a.property,n("StartScene",S("StartScene")(p=function(n){e(a,n);var c=a.prototype;function a(){return n.call(this,"Start")||this}return c.init=function(){s.ins[f.CURSTAGEINFO]=0},c.update=function(n){i.ins.setNewScene(new u)},c.release=function(){},c.preload=function(){var n=t(r().mark((function n(){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),a}(o))||p);c._RF.pop()}}}));

System.register("chunks:///_virtual/StaticConfig.ts",["cc","./BuffStaticConfig.ts","./CharStaticConfig.ts","./SkillStaticConfig.ts","./StageConfig.ts"],(function(t){var i,n,c,S,f;return{setters:[function(t){i=t.cclegacy},function(t){n=t.BFSC},function(t){c=t.CharSC},function(t){S=t.SKSC},function(t){f=t.StageConfig}],execute:function(){i._RF.push({},"fc0f8hXxLJLo4MAEz/QE7lc","StaticConfig",void 0);t("GSC",{TILEAPR:[0,15,200,200],SKSC:S,BFSC:n,CHARSC:c,STAGESC:f});i._RF.pop()}}}));

System.register("chunks:///_virtual/Toast.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BaseToast.ts"],(function(t){var e,i,n,o;return{setters:[function(t){e=t.extends},function(t){i=t.cclegacy},function(e){n=e.BaseToast,o=e.Gravity,t("Gravity",e.Gravity)}],execute:function(){i._RF.push({},"720aa1RIhFKcIk2Qjl5wWY+","Toast",void 0);var s=[],u=t("Toast",function(){function t(){}return t.show=function(i,o,u){void 0===o&&(o=n.LENGTH_SHORT),void 0===u&&(u=t.defaultOptions);var a=e({},this.defaultOptions,u),r=n.makeText(i,o,null).setGravity(a.gravity).setTextSize(a.textSize).setLineheight(a.lineHeight);return s.push(r),setTimeout((function(){s.forEach((function(t){return!t.isDestroy&&t.show()}))}),0),r},t.hideAll=function(){setTimeout((function(){s=[]}),0)},t}());u.LENGTH_SHORT=n.LENGTH_SHORT,u.LENGTH_LONG=n.LENGTH_LONG,u.defaultOptions={gravity:o.TOP,textSize:14,lineHeight:2},i._RF.pop()}}}));

System.register("chunks:///_virtual/WXSDKAdapter.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SDKAdapterBase.ts"],(function(t){var e,n,r,a,o;return{setters:[function(t){e=t.inheritsLoose,n=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){a=t.cclegacy},function(t){o=t.SDKAdapterBase}],execute:function(){a._RF.push({},"9e7achWw79ANaA8HC1Dq5Mf","WXSDKAdapter",void 0);t("WXSDKAdapter",function(t){function a(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).WXSDK=window.wx,e._coll=void 0,e._db=void 0,e}e(a,t);var o=a.prototype;return o.init=function(){this.WXSDK.cloud.init();var t=this.WXSDK.cloud.database(),e=t.collection("zilihangjian");this._coll=e,this._db=t},o.call=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this[t]?this[t].apply(this,n):(a=this.WXSDK)[t].apply(a,n);var a},o.getObj=function(t){return this[t]?this[t]:this.WXSDK[t]},o.setUserCloudStorage=function(t){this.WXSDK.setUserCloudStorage(t)},o.removeUserCloudStorage=function(t){this.WXSDK.removeUserCloudStorage(t)},o.getUserCloudStorageKeys=function(t){this.WXSDK.getUserCloudStorageKeys(t)},o.getUserCloudStorage=function(t){this.WXSDK.getUserCloudStorage(t)},o.callCloudFunction=function(){var t=n(r().mark((function t(){var e,n=arguments;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(e=this.WXSDK.cloud).callFunction.apply(e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.postMessageToOpenContext=function(t){this.WXSDK.getOpenDataContext().postMessage(t)},o.getDataVersion=function(){var t=n(r().mark((function t(){var e,n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._db.collection("zilihangjian_rankdata").doc("dataversion").get();case 2:if(!(e=t.sent)||!e.data){t.next=6;break}return n=e.data.version,t.abrupt("return",n);case 6:return t.abrupt("return",0);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.getUserInfo=function(){var t=n(r().mark((function t(){var e,n,a,o,i,s;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.callCloudFunction({name:"GetUserInfoTest"});case 2:return e=t.sent,n=e.result.openid,a=e.result.clientIp,console.log("获得用户openid"),o={},t.next=9,this._coll.where({openid:n}).get();case 9:if(i=t.sent,(s=i.data).length>0&&(console.log("查找到用户数据,读取用户数据..."),o=s[0]),0!=s.length){t.next=17;break}return o.openid=n,console.log("数据库中未找到用户信息,新建用户信息..."),t.next=17,this._coll.add({data:o});case 17:return delete o._openid,delete o._id,o.lastIp=a,t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.updateDBUserInfo=function(){var t=n(r().mark((function t(e){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("将用户数据写入持久层"),t.next=3,this._coll.where({openid:e.openid}).update({data:e});case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),o.setStorage=function(t){this.WXSDK.setStorage(t)},o.getStorageSync=function(t){var e=this.WXSDK.getStorageSync(t);return""==e?null:e},o.getStorage=function(){var t=n(r().mark((function t(e){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.WXSDK.getStorage({key:e});case 3:return t.abrupt("return",t.sent.data);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,this,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),o.getWorldRankDataFromServer=function(){var t=n(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._db.collection("zilihangjian_rankdata").doc("WorldRankData").get();case 2:return t.abrupt("return",t.sent.data.data);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.getProvRankDataFromServer=function(){var t=n(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._db.collection("zilihangjian_rankdata").doc("ProvRankData").get();case 2:return t.abrupt("return",t.sent.data.data);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),o.loadSubPackage=function(t,e){var n=this;return void 0===e&&(e=null),new Promise((function(r,a){n.WXSDK.loadSubpackage({name:t,fail:a,success:function(t){e&&e(t),r(t)}}).onProgressUpdate((function(t){console.log("下载进度",t.progress),console.log("已经下载的数据长度",t.totalBytesWritten),console.log("预期需要下载的数据总长度",t.totalBytesExpectedToWrite)}))}))},o.readFileFromCloud=function(){var t=n(r().mark((function t(e,n,a){var o,i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=null),void 0===a&&(a="utf8"),t.next=4,this.getDownLoadTempFilePath(e);case 4:return o=t.sent,t.next=7,this.readTmpfileFromPath(o,a);case 7:return i=t.sent,n&&n(i),t.abrupt("return",i);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}(),o.readTmpfileFromPath=function(t,e){var n=this;return void 0===e&&(e="utf8"),new Promise((function(r,a){n.WXSDK.getFileSystemManager().readFile({filePath:t,encoding:e,position:0,success:function(t){r(t.data)},fail:function(t){a(t)}})}))},o.getDownLoadTempFilePath=function(t){var e=this;return new Promise((function(n,r){e.WXSDK.cloud.downloadFile({fileID:t,success:function(t){n(t.tempFilePath)},fail:function(t){r(t)}})}))},a}(o));a._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});